[0m13:06:47.959830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c83e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c83dad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c898d10>]}


============================== 13:06:47.962562 | d8670c2f-a0cf-48b7-89c5-66ebbfdc0589 ==============================
[0m13:06:47.962562 [info ] [MainThread]: Running with dbt=1.10.2
[0m13:06:47.962889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt init my_dbt_postgres_project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:06:47.969504 [info ] [MainThread]: Setting up your profile.
[0m13:07:48.351221 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 60.436283, "process_in_blocks": "0", "process_kernel_time": 0.112587, "process_mem_max_rss": "108216320", "process_out_blocks": "0", "process_user_time": 0.618032}
[0m13:07:48.352322 [debug] [MainThread]: Command `dbt init` succeeded at 13:07:48.352186 after 60.44 seconds
[0m13:07:48.352858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104804750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048047d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c831210>]}
[0m13:07:48.353358 [debug] [MainThread]: Flushing usage events
[0m13:07:49.051555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:27.113672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106817d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106817b10>]}


============================== 13:12:27.116803 | e902f9b3-13c3-461d-a512-744d3d456dce ==============================
[0m13:12:27.116803 [info ] [MainThread]: Running with dbt=1.9.8
[0m13:12:27.117117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/maha/.dbt', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:12:27.349989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e902f9b3-13c3-461d-a512-744d3d456dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d64e90>]}
[0m13:12:27.382345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e902f9b3-13c3-461d-a512-744d3d456dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668f460>]}
[0m13:12:27.383242 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:12:27.465582 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m13:12:27.466123 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:12:27.466309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e902f9b3-13c3-461d-a512-744d3d456dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106743050>]}
[0m13:12:28.078515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e902f9b3-13c3-461d-a512-744d3d456dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742a8a0>]}
[0m13:12:28.117261 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:12:28.118863 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:12:28.135759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e902f9b3-13c3-461d-a512-744d3d456dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107592890>]}
[0m13:12:28.136005 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 433 macros
[0m13:12:28.136165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e902f9b3-13c3-461d-a512-744d3d456dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748ac30>]}
[0m13:12:28.137008 [info ] [MainThread]: 
[0m13:12:28.137168 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:12:28.137296 [info ] [MainThread]: 
[0m13:12:28.137522 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:12:28.137921 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m13:12:28.187431 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m13:12:28.187683 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m13:12:28.187827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:28.340092 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.152 seconds
[0m13:12:28.341425 [debug] [ThreadPool]: On list_dbt_db: Close
[0m13:12:28.341998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now create_dbt_db_schema_db)
[0m13:12:28.342542 [debug] [ThreadPool]: Creating schema "database: "dbt_db"
schema: "schema_db"
"
[0m13:12:28.346448 [debug] [ThreadPool]: Using postgres connection "create_dbt_db_schema_db"
[0m13:12:28.346740 [debug] [ThreadPool]: On create_dbt_db_schema_db: BEGIN
[0m13:12:28.346941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:28.352719 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:12:28.352951 [debug] [ThreadPool]: Using postgres connection "create_dbt_db_schema_db"
[0m13:12:28.353137 [debug] [ThreadPool]: On create_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "create_dbt_db_schema_db"} */
create schema if not exists "schema_db"
[0m13:12:28.364064 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.011 seconds
[0m13:12:28.364748 [debug] [ThreadPool]: On create_dbt_db_schema_db: COMMIT
[0m13:12:28.364951 [debug] [ThreadPool]: Using postgres connection "create_dbt_db_schema_db"
[0m13:12:28.365129 [debug] [ThreadPool]: On create_dbt_db_schema_db: COMMIT
[0m13:12:28.366539 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m13:12:28.366725 [debug] [ThreadPool]: On create_dbt_db_schema_db: Close
[0m13:12:28.369924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_db_schema_db, now list_dbt_db_schema_db)
[0m13:12:28.374197 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m13:12:28.374514 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m13:12:28.374696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:28.382331 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:12:28.382648 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m13:12:28.382856 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m13:12:28.401587 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m13:12:28.402548 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m13:12:28.402997 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m13:12:28.406894 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:28.407173 [debug] [MainThread]: On master: BEGIN
[0m13:12:28.407355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:28.414833 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:12:28.415068 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:28.415341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:12:28.426282 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m13:12:28.427166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e902f9b3-13c3-461d-a512-744d3d456dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e4890>]}
[0m13:12:28.427521 [debug] [MainThread]: On master: ROLLBACK
[0m13:12:28.427966 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:28.428154 [debug] [MainThread]: On master: BEGIN
[0m13:12:28.428890 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:12:28.429078 [debug] [MainThread]: On master: COMMIT
[0m13:12:28.429249 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:28.429415 [debug] [MainThread]: On master: COMMIT
[0m13:12:28.429861 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:12:28.430062 [debug] [MainThread]: On master: Close
[0m13:12:28.433942 [debug] [Thread-1 (]: Began running node seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285
[0m13:12:28.434314 [info ] [Thread-1 (]: 1 of 1 START seed file schema_db.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285  [RUN]
[0m13:12:28.434615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285)
[0m13:12:28.434847 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285
[0m13:12:28.435068 [debug] [Thread-1 (]: Began executing node seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285
[0m13:12:28.868281 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285"
[0m13:12:28.868567 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285: BEGIN
[0m13:12:28.868727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:28.876042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:12:28.876245 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285"
[0m13:12:28.876422 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285"} */

    create table "dbt_db"."schema_db"."ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285" ("Organization Link" integer,"Organization" text,"Location" text,"Location Ref" integer,"Account Style Link" integer,"Account Style Caption" text,"Account Subtype" integer,"Account Number" text,"Account Reference" integer,"Account Supplier" text,"Account Reader" integer,"Record Start YYYY-MM-DD" date,"Record End YYYY-MM-DD" date,"Record Data Quality" text,"Record Billing Type" text,"Record Subtype" text,"Record Entry Method" text,"Record Reference" integer,"Record Invoice Number" integer,"Quantity" integer,"Total Cost" integer)
  
[0m13:12:28.899891 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.023 seconds
[0m13:12:40.930867 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285"
[0m13:12:40.931270 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285: 
          insert into "dbt_db"."schema_db"."ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285" ("Organization Link", "Organization", "Location", "Location Ref", "Account Style Link", "Account Style Caption", "Account Subtype", "Account Number", "Account Reference", "Account Supplier", "Account Reader", "Record Start YYYY-MM-DD", "Record End YYYY-MM-DD", "Record Data Quality", "Record Billing Type", "Record Subtype", "Record Entry Method", "Record Reference", "Record Invoice Number", "Quantity", "...
[0m13:12:41.193232 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.262 seconds
[0m13:12:41.199251 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285"
[0m13:12:41.215808 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285: COMMIT
[0m13:12:41.216136 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285"
[0m13:12:41.216389 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285: COMMIT
[0m13:12:41.217878 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:12:41.218888 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285: Close
[0m13:12:41.220204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e902f9b3-13c3-461d-a512-744d3d456dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c9440>]}
[0m13:12:41.220493 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file schema_db.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285  [[32mINSERT 10000[0m in 12.78s]
[0m13:12:41.220782 [debug] [Thread-1 (]: Finished running node seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285
[0m13:12:41.221759 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:41.221908 [debug] [MainThread]: On master: BEGIN
[0m13:12:41.222032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:12:41.228728 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:12:41.229005 [debug] [MainThread]: On master: COMMIT
[0m13:12:41.229168 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:41.229310 [debug] [MainThread]: On master: COMMIT
[0m13:12:41.229678 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:12:41.229901 [debug] [MainThread]: On master: Close
[0m13:12:41.230166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:41.230319 [debug] [MainThread]: Connection 'seed.my_dbt_postgres_project.ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285' was properly closed.
[0m13:12:41.230483 [info ] [MainThread]: 
[0m13:12:41.230659 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 13.09 seconds (13.09s).
[0m13:12:41.231023 [debug] [MainThread]: Command end result
[0m13:12:41.242065 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:12:41.243325 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:12:41.246332 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m13:12:41.246527 [info ] [MainThread]: 
[0m13:12:41.246808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:12:41.246982 [info ] [MainThread]: 
[0m13:12:41.247136 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:12:41.248932 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 14.175414, "process_in_blocks": "0", "process_kernel_time": 0.216993, "process_mem_max_rss": "181403648", "process_out_blocks": "0", "process_user_time": 13.938756}
[0m13:12:41.249243 [debug] [MainThread]: Command `dbt seed` succeeded at 13:12:41.249190 after 14.18 seconds
[0m13:12:41.249471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107700ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107494a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c37d0>]}
[0m13:12:41.249662 [debug] [MainThread]: Flushing usage events
[0m13:12:41.848978 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:11.010129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107962120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d3b10>]}


============================== 13:39:11.014045 | a1d75526-79ea-4403-b061-c9cd7d704891 ==============================
[0m13:39:11.014045 [info ] [MainThread]: Running with dbt=1.9.8
[0m13:39:11.014384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:11.123672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1d75526-79ea-4403-b061-c9cd7d704891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c3ce90>]}
[0m13:39:11.157467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1d75526-79ea-4403-b061-c9cd7d704891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10904b460>]}
[0m13:39:11.158354 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:39:11.230271 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m13:39:11.310618 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m13:39:11.311002 [debug] [MainThread]: Partial parsing: added file: my_dbt_postgres_project://tests/Country_Code_Test.yml
[0m13:39:11.311167 [debug] [MainThread]: Partial parsing: added file: my_dbt_postgres_project://seeds/country_codes.csv
[0m13:39:11.311293 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_postgres_project://seeds/ENV_AppCon_Account_PM&C_Data_Sup_v1_ADNOC_20240103054753285.csv
[0m13:39:11.423395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1d75526-79ea-4403-b061-c9cd7d704891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e71e50>]}
[0m13:39:11.463474 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:39:11.465425 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:39:11.477548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1d75526-79ea-4403-b061-c9cd7d704891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972ae40>]}
[0m13:39:11.477813 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 433 macros
[0m13:39:11.477981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1d75526-79ea-4403-b061-c9cd7d704891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a098bb0>]}
[0m13:39:11.478893 [info ] [MainThread]: 
[0m13:39:11.479067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:11.479193 [info ] [MainThread]: 
[0m13:39:11.479441 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:39:11.479850 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m13:39:11.516256 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m13:39:11.516513 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m13:39:11.516661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:11.564397 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.048 seconds
[0m13:39:11.565332 [debug] [ThreadPool]: On list_dbt_db: Close
[0m13:39:11.567730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_schema_db)
[0m13:39:11.570533 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m13:39:11.570692 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m13:39:11.570823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:11.577053 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:39:11.577256 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m13:39:11.577401 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m13:39:11.585170 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m13:39:11.585862 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m13:39:11.586253 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m13:39:11.588445 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:11.588612 [debug] [MainThread]: On master: BEGIN
[0m13:39:11.588737 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:11.600829 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:39:11.601041 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:11.601229 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:39:11.612763 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m13:39:11.613494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1d75526-79ea-4403-b061-c9cd7d704891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0714a0>]}
[0m13:39:11.613752 [debug] [MainThread]: On master: ROLLBACK
[0m13:39:11.614093 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:11.614234 [debug] [MainThread]: On master: BEGIN
[0m13:39:11.614694 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:39:11.614834 [debug] [MainThread]: On master: COMMIT
[0m13:39:11.614963 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:11.615085 [debug] [MainThread]: On master: COMMIT
[0m13:39:11.615363 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:39:11.615506 [debug] [MainThread]: On master: Close
[0m13:39:11.617880 [debug] [Thread-1 (]: Began running node seed.my_dbt_postgres_project.country_codes
[0m13:39:11.618190 [info ] [Thread-1 (]: 1 of 1 START seed file schema_db.country_codes ................................. [RUN]
[0m13:39:11.618435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now seed.my_dbt_postgres_project.country_codes)
[0m13:39:11.618606 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_postgres_project.country_codes
[0m13:39:11.618770 [debug] [Thread-1 (]: Began executing node seed.my_dbt_postgres_project.country_codes
[0m13:39:11.634450 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.country_codes"
[0m13:39:11.634729 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: BEGIN
[0m13:39:11.634881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:11.645337 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:39:11.645636 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.country_codes"
[0m13:39:11.645848 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "seed.my_dbt_postgres_project.country_codes"} */

    create table "dbt_db"."schema_db"."country_codes" ("country_name" text,"country_code" text)
  
[0m13:39:11.653207 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.007 seconds
[0m13:39:11.666972 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.country_codes"
[0m13:39:11.667226 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: 
          insert into "dbt_db"."schema_db"."country_codes" ("country_name", "country_code") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m13:39:11.676619 [debug] [Thread-1 (]: SQL status: INSERT 0 41 in 0.009 seconds
[0m13:39:11.679877 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_dbt_postgres_project.country_codes"
[0m13:39:11.689256 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: COMMIT
[0m13:39:11.689491 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.country_codes"
[0m13:39:11.689642 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: COMMIT
[0m13:39:11.691678 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:39:11.692628 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: Close
[0m13:39:11.693675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1d75526-79ea-4403-b061-c9cd7d704891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a115f10>]}
[0m13:39:11.694065 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file schema_db.country_codes ............................. [[32mINSERT 41[0m in 0.07s]
[0m13:39:11.694371 [debug] [Thread-1 (]: Finished running node seed.my_dbt_postgres_project.country_codes
[0m13:39:11.695048 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:11.695241 [debug] [MainThread]: On master: BEGIN
[0m13:39:11.695386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:11.700400 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:39:11.700575 [debug] [MainThread]: On master: COMMIT
[0m13:39:11.700704 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:11.700870 [debug] [MainThread]: On master: COMMIT
[0m13:39:11.701090 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:39:11.701213 [debug] [MainThread]: On master: Close
[0m13:39:11.701388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:11.701497 [debug] [MainThread]: Connection 'seed.my_dbt_postgres_project.country_codes' was properly closed.
[0m13:39:11.701619 [info ] [MainThread]: 
[0m13:39:11.701805 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m13:39:11.702113 [debug] [MainThread]: Command end result
[0m13:39:11.712881 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:39:11.713852 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:39:11.717941 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m13:39:11.718182 [info ] [MainThread]: 
[0m13:39:11.718385 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:11.718528 [info ] [MainThread]: 
[0m13:39:11.718678 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:39:11.720425 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.7547215, "process_in_blocks": "0", "process_kernel_time": 0.215492, "process_mem_max_rss": "129253376", "process_out_blocks": "0", "process_user_time": 1.082725}
[0m13:39:11.720727 [debug] [MainThread]: Command `dbt seed` succeeded at 13:39:11.720622 after 0.76 seconds
[0m13:39:11.721031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a12a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4ce0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4cde50>]}
[0m13:39:11.721223 [debug] [MainThread]: Flushing usage events
[0m13:39:12.439039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:14.692405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c63d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c63b10>]}


============================== 13:41:14.696317 | a1179bdf-d499-4a30-8958-d0fa8e50f2f0 ==============================
[0m13:41:14.696317 [info ] [MainThread]: Running with dbt=1.9.8
[0m13:41:14.696725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:41:14.799320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1179bdf-d499-4a30-8958-d0fa8e50f2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ace90>]}
[0m13:41:14.832247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1179bdf-d499-4a30-8958-d0fa8e50f2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108adb460>]}
[0m13:41:14.833698 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:41:14.881718 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m13:41:14.961390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:41:14.961652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:41:14.984886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1179bdf-d499-4a30-8958-d0fa8e50f2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c9650>]}
[0m13:41:15.021715 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:41:15.023418 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:41:15.039651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1179bdf-d499-4a30-8958-d0fa8e50f2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d20c80>]}
[0m13:41:15.039905 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 433 macros
[0m13:41:15.040065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1179bdf-d499-4a30-8958-d0fa8e50f2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd0590>]}
[0m13:41:15.040978 [info ] [MainThread]: 
[0m13:41:15.041158 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:41:15.041288 [info ] [MainThread]: 
[0m13:41:15.041519 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:41:15.043389 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_schema_db'
[0m13:41:15.079778 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m13:41:15.080024 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m13:41:15.080165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:15.131363 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m13:41:15.131641 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m13:41:15.131809 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m13:41:15.135477 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:41:15.136366 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m13:41:15.136684 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m13:41:15.139308 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:15.139562 [debug] [MainThread]: On master: BEGIN
[0m13:41:15.139787 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:15.144257 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:41:15.144421 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:15.144597 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:41:15.152688 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m13:41:15.153498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1179bdf-d499-4a30-8958-d0fa8e50f2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f16750>]}
[0m13:41:15.153795 [debug] [MainThread]: On master: ROLLBACK
[0m13:41:15.154180 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:15.154358 [debug] [MainThread]: On master: BEGIN
[0m13:41:15.154883 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:41:15.155028 [debug] [MainThread]: On master: COMMIT
[0m13:41:15.155153 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:15.155269 [debug] [MainThread]: On master: COMMIT
[0m13:41:15.155538 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:41:15.155667 [debug] [MainThread]: On master: Close
[0m13:41:15.157882 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:41:15.158097 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m13:41:15.158311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710)
[0m13:41:15.158472 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:41:15.167318 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:41:15.168083 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:41:15.178490 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:41:15.179418 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:41:15.179657 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m13:41:15.179934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:15.185347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:41:15.185596 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:41:15.185758 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dbt_db"."schema_db"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:41:15.187113 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "schema_db.my_first_dbt_model" does not exist
LINE 17: from "dbt_db"."schema_db"."my_first_dbt_model"
              ^

[0m13:41:15.187333 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m13:41:15.187640 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m13:41:15.193434 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_first_dbt_model" does not exist
  LINE 17: from "dbt_db"."schema_db"."my_first_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m13:41:15.193838 [error] [Thread-1 (]: 1 of 4 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.04s]
[0m13:41:15.194120 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:41:15.194310 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:41:15.194570 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_first_dbt_model" does not exist
  LINE 17: from "dbt_db"."schema_db"."my_first_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql.
[0m13:41:15.194803 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m13:41:15.195469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778)
[0m13:41:15.195659 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:41:15.198007 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:41:15.198480 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:41:15.199451 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:41:15.199793 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:41:15.199948 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m13:41:15.200155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:15.204799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:41:15.205007 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:41:15.205158 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dbt_db"."schema_db"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:41:15.205792 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "schema_db.my_second_dbt_model" does not exist
LINE 17: from "dbt_db"."schema_db"."my_second_dbt_model"
              ^

[0m13:41:15.205956 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m13:41:15.206419 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m13:41:15.208759 [debug] [Thread-1 (]: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_second_dbt_model" does not exist
  LINE 17: from "dbt_db"."schema_db"."my_second_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m13:41:15.209783 [error] [Thread-1 (]: 2 of 4 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.01s]
[0m13:41:15.210217 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:41:15.210575 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m13:41:15.210931 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_second_dbt_model" does not exist
  LINE 17: from "dbt_db"."schema_db"."my_second_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/not_null_my_second_dbt_model_id.sql.
[0m13:41:15.211585 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m13:41:15.212035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778, now test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321)
[0m13:41:15.212244 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m13:41:15.215985 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:41:15.216505 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m13:41:15.218168 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:41:15.218689 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:41:15.218860 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m13:41:15.219005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:15.225492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:41:15.225775 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:41:15.225946 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt_db"."schema_db"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:41:15.226517 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "schema_db.my_first_dbt_model" does not exist
LINE 18: from "dbt_db"."schema_db"."my_first_dbt_model"
              ^

[0m13:41:15.226807 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m13:41:15.227134 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:41:15.229401 [debug] [Thread-1 (]: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_first_dbt_model" does not exist
  LINE 18: from "dbt_db"."schema_db"."my_first_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m13:41:15.229692 [error] [Thread-1 (]: 3 of 4 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 0.02s]
[0m13:41:15.229958 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m13:41:15.230137 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:41:15.230426 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_first_dbt_model" does not exist
  LINE 18: from "dbt_db"."schema_db"."my_first_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/unique_my_first_dbt_model_id.sql.
[0m13:41:15.230652 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m13:41:15.230982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321, now test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:41:15.231216 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:41:15.233286 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:41:15.233801 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:41:15.234830 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:41:15.235196 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:41:15.235565 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m13:41:15.235776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:15.247354 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:41:15.247626 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:41:15.247856 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt_db"."schema_db"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:41:15.256373 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "schema_db.my_second_dbt_model" does not exist
LINE 18: from "dbt_db"."schema_db"."my_second_dbt_model"
              ^

[0m13:41:15.256671 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m13:41:15.257205 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m13:41:15.259463 [debug] [Thread-1 (]: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_second_dbt_model" does not exist
  LINE 18: from "dbt_db"."schema_db"."my_second_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m13:41:15.259757 [error] [Thread-1 (]: 4 of 4 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.03s]
[0m13:41:15.260076 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:41:15.260470 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_second_dbt_model" does not exist
  LINE 18: from "dbt_db"."schema_db"."my_second_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/unique_my_second_dbt_model_id.sql.
[0m13:41:15.261257 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:15.261471 [debug] [MainThread]: On master: BEGIN
[0m13:41:15.261615 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:15.266830 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:41:15.267173 [debug] [MainThread]: On master: COMMIT
[0m13:41:15.267325 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:15.267453 [debug] [MainThread]: On master: COMMIT
[0m13:41:15.267806 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:41:15.268004 [debug] [MainThread]: On master: Close
[0m13:41:15.268324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:15.268442 [debug] [MainThread]: Connection 'test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:41:15.268595 [info ] [MainThread]: 
[0m13:41:15.268736 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m13:41:15.269491 [debug] [MainThread]: Command end result
[0m13:41:15.281757 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:41:15.282703 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:41:15.286874 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m13:41:15.287085 [info ] [MainThread]: 
[0m13:41:15.287283 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:41:15.287431 [info ] [MainThread]: 
[0m13:41:15.287607 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_first_dbt_model" does not exist
  LINE 17: from "dbt_db"."schema_db"."my_first_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m13:41:15.287734 [info ] [MainThread]: 
[0m13:41:15.287882 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_second_dbt_model" does not exist
  LINE 17: from "dbt_db"."schema_db"."my_second_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m13:41:15.288000 [info ] [MainThread]: 
[0m13:41:15.288144 [error] [MainThread]:   Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_first_dbt_model" does not exist
  LINE 18: from "dbt_db"."schema_db"."my_first_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m13:41:15.288257 [info ] [MainThread]: 
[0m13:41:15.288390 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_second_dbt_model" does not exist
  LINE 18: from "dbt_db"."schema_db"."my_second_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m13:41:15.288505 [info ] [MainThread]: 
[0m13:41:15.288635 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m13:41:15.290241 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.6470845, "process_in_blocks": "0", "process_kernel_time": 0.198969, "process_mem_max_rss": "128909312", "process_out_blocks": "0", "process_user_time": 1.00694}
[0m13:41:15.290565 [debug] [MainThread]: Command `dbt test` failed at 13:41:15.290512 after 0.65 seconds
[0m13:41:15.290783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c44b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a12caa0>]}
[0m13:41:15.290979 [debug] [MainThread]: Flushing usage events
[0m13:41:16.018544 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:42:09.492074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106236120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d3b10>]}


============================== 13:42:09.495287 | aa9da6d9-14dc-4e31-863b-bb225fcadb99 ==============================
[0m13:42:09.495287 [info ] [MainThread]: Running with dbt=1.9.8
[0m13:42:09.495626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'profiles_dir': '/Users/maha/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select Country_Code_Test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:42:09.604511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa9da6d9-14dc-4e31-863b-bb225fcadb99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106718e90>]}
[0m13:42:09.636890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa9da6d9-14dc-4e31-863b-bb225fcadb99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744b460>]}
[0m13:42:09.637509 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:42:09.680178 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m13:42:09.742082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:42:09.742309 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:42:09.766857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa9da6d9-14dc-4e31-863b-bb225fcadb99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204cd650>]}
[0m13:42:09.805576 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:42:09.807134 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:42:09.819414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa9da6d9-14dc-4e31-863b-bb225fcadb99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122020c80>]}
[0m13:42:09.819661 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 433 macros
[0m13:42:09.819828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa9da6d9-14dc-4e31-863b-bb225fcadb99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205d8590>]}
[0m13:42:09.820146 [warn ] [MainThread]: The selection criterion 'Country_Code_Test' does not match any enabled nodes
[0m13:42:09.820719 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:42:09.821615 [debug] [MainThread]: Command end result
[0m13:42:09.833002 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:42:09.833876 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:42:09.835523 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m13:42:09.836490 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.38979962, "process_in_blocks": "0", "process_kernel_time": 0.141763, "process_mem_max_rss": "118849536", "process_out_blocks": "0", "process_user_time": 0.910103}
[0m13:42:09.836716 [debug] [MainThread]: Command `dbt test` succeeded at 13:42:09.836672 after 0.39 seconds
[0m13:42:09.836897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205ab790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120665490>]}
[0m13:42:09.837056 [debug] [MainThread]: Flushing usage events
[0m13:42:10.441170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:26.333839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d3b10>]}


============================== 13:44:26.337468 | 37f3ed15-f08b-468a-9937-5fdafed69ca9 ==============================
[0m13:44:26.337468 [info ] [MainThread]: Running with dbt=1.9.8
[0m13:44:26.337793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select Country_Codes', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:26.447020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37f3ed15-f08b-468a-9937-5fdafed69ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105318e90>]}
[0m13:44:26.479490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37f3ed15-f08b-468a-9937-5fdafed69ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4b460>]}
[0m13:44:26.481173 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:44:26.565070 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m13:44:26.646588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:26.646832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:26.670005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37f3ed15-f08b-468a-9937-5fdafed69ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c9650>]}
[0m13:44:26.706996 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:44:26.708815 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:44:26.725847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37f3ed15-f08b-468a-9937-5fdafed69ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108920c80>]}
[0m13:44:26.726110 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 433 macros
[0m13:44:26.726282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f3ed15-f08b-468a-9937-5fdafed69ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d0590>]}
[0m13:44:26.726651 [warn ] [MainThread]: The selection criterion 'Country_Codes' does not match any enabled nodes
[0m13:44:26.727276 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:44:26.728197 [debug] [MainThread]: Command end result
[0m13:44:26.739907 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:44:26.740723 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:44:26.742226 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m13:44:26.743825 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4552578, "process_in_blocks": "0", "process_kernel_time": 0.177505, "process_mem_max_rss": "118669312", "process_out_blocks": "0", "process_user_time": 0.903402}
[0m13:44:26.744272 [debug] [MainThread]: Command `dbt test` succeeded at 13:44:26.744151 after 0.46 seconds
[0m13:44:26.744536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108869490>]}
[0m13:44:26.744734 [debug] [MainThread]: Flushing usage events
[0m13:44:27.453998 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:55.537270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d3b10>]}


============================== 13:44:55.540238 | 436c047f-98dd-4fc4-8b78-e6621fad39af ==============================
[0m13:44:55.540238 [info ] [MainThread]: Running with dbt=1.9.8
[0m13:44:55.540559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/maha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select country_codes', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:55.627024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '436c047f-98dd-4fc4-8b78-e6621fad39af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082dce90>]}
[0m13:44:55.660476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '436c047f-98dd-4fc4-8b78-e6621fad39af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914b460>]}
[0m13:44:55.661067 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:44:55.727759 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m13:44:55.788918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:55.789172 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:55.813997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '436c047f-98dd-4fc4-8b78-e6621fad39af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109859650>]}
[0m13:44:55.853156 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:44:55.854701 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:44:55.867091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '436c047f-98dd-4fc4-8b78-e6621fad39af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a820c80>]}
[0m13:44:55.867341 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 433 macros
[0m13:44:55.867508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '436c047f-98dd-4fc4-8b78-e6621fad39af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed0590>]}
[0m13:44:55.868197 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:44:55.869125 [debug] [MainThread]: Command end result
[0m13:44:55.880590 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:44:55.881506 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:44:55.883410 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m13:44:55.884405 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.39120463, "process_in_blocks": "0", "process_kernel_time": 0.138516, "process_mem_max_rss": "117899264", "process_out_blocks": "0", "process_user_time": 0.905139}
[0m13:44:55.884653 [debug] [MainThread]: Command `dbt test` succeeded at 13:44:55.884602 after 0.39 seconds
[0m13:44:55.884846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f6d490>]}
[0m13:44:55.885019 [debug] [MainThread]: Flushing usage events
[0m13:44:56.480581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:19.930506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd3b10>]}


============================== 13:45:19.933879 | d684ccae-a458-4830-9327-be89337751d7 ==============================
[0m13:45:19.933879 [info ] [MainThread]: Running with dbt=1.9.8
[0m13:45:19.934218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select country_codes.csv', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:45:20.021459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd684ccae-a458-4830-9327-be89337751d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106220e90>]}
[0m13:45:20.054397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd684ccae-a458-4830-9327-be89337751d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4b460>]}
[0m13:45:20.054914 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:45:20.098804 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m13:45:20.161125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:45:20.161355 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:45:20.184955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd684ccae-a458-4830-9327-be89337751d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b79650>]}
[0m13:45:20.223598 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:45:20.225156 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:45:20.237876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd684ccae-a458-4830-9327-be89337751d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd0c80>]}
[0m13:45:20.238152 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 433 macros
[0m13:45:20.238312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd684ccae-a458-4830-9327-be89337751d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c80590>]}
[0m13:45:20.239168 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:45:20.240171 [debug] [MainThread]: Command end result
[0m13:45:20.252170 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:45:20.253273 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:45:20.255093 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m13:45:20.256010 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.37099338, "process_in_blocks": "0", "process_kernel_time": 0.138746, "process_mem_max_rss": "116441088", "process_out_blocks": "0", "process_user_time": 0.888681}
[0m13:45:20.256256 [debug] [MainThread]: Command `dbt test` succeeded at 13:45:20.256206 after 0.37 seconds
[0m13:45:20.256561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c53790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d15490>]}
[0m13:45:20.256746 [debug] [MainThread]: Flushing usage events
[0m13:45:20.853307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:19.315966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109e6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125d3b10>]}


============================== 13:46:19.319947 | 544ac206-de0d-47a7-abff-11327fcf68ac ==============================
[0m13:46:19.319947 [info ] [MainThread]: Running with dbt=1.9.8
[0m13:46:19.320321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'debug': 'False', 'profiles_dir': '/Users/maha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select country_codes', 'send_anonymous_usage_stats': 'True'}
[0m13:46:19.421961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '544ac206-de0d-47a7-abff-11327fcf68ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11101ce90>]}
[0m13:46:19.454975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '544ac206-de0d-47a7-abff-11327fcf68ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11244b460>]}
[0m13:46:19.456511 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:46:19.504136 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m13:46:19.580657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:19.580916 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:19.604873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '544ac206-de0d-47a7-abff-11327fcf68ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c1d650>]}
[0m13:46:19.644223 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:46:19.645907 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:46:19.662030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '544ac206-de0d-47a7-abff-11327fcf68ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114620c80>]}
[0m13:46:19.662292 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 433 macros
[0m13:46:19.662469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '544ac206-de0d-47a7-abff-11327fcf68ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d28590>]}
[0m13:46:19.663177 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:46:19.664092 [debug] [MainThread]: Command end result
[0m13:46:19.675492 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:46:19.676340 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:46:19.678109 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m13:46:19.679322 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.41292784, "process_in_blocks": "0", "process_kernel_time": 0.166635, "process_mem_max_rss": "116195328", "process_out_blocks": "0", "process_user_time": 0.903834}
[0m13:46:19.679582 [debug] [MainThread]: Command `dbt test` succeeded at 13:46:19.679533 after 0.41 seconds
[0m13:46:19.679774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cf3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125b4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f5d490>]}
[0m13:46:19.679939 [debug] [MainThread]: Flushing usage events
[0m13:46:20.374415 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:25.329744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d6e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d3b10>]}


============================== 13:46:25.332688 | f593a342-9b98-4771-9e57-0d4f8bc2a73a ==============================
[0m13:46:25.332688 [info ] [MainThread]: Running with dbt=1.9.8
[0m13:46:25.332998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'debug': 'False', 'profiles_dir': '/Users/maha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:46:25.420970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f593a342-9b98-4771-9e57-0d4f8bc2a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104044e90>]}
[0m13:46:25.454398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f593a342-9b98-4771-9e57-0d4f8bc2a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534b460>]}
[0m13:46:25.454943 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:46:25.525595 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m13:46:25.586705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:25.587027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:25.613493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f593a342-9b98-4771-9e57-0d4f8bc2a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c9650>]}
[0m13:46:25.652643 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:46:25.654231 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:46:25.666775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f593a342-9b98-4771-9e57-0d4f8bc2a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106620c80>]}
[0m13:46:25.667039 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 433 macros
[0m13:46:25.667204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f593a342-9b98-4771-9e57-0d4f8bc2a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d0590>]}
[0m13:46:25.668120 [info ] [MainThread]: 
[0m13:46:25.668312 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:25.668470 [info ] [MainThread]: 
[0m13:46:25.668759 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:46:25.670709 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_schema_db'
[0m13:46:25.707515 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m13:46:25.707757 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m13:46:25.707899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:25.732810 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m13:46:25.733069 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m13:46:25.733218 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m13:46:25.738132 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m13:46:25.738906 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m13:46:25.739332 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m13:46:25.741734 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:25.741932 [debug] [MainThread]: On master: BEGIN
[0m13:46:25.742068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:25.747338 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:46:25.747489 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:25.747651 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:46:25.756812 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m13:46:25.757561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f593a342-9b98-4771-9e57-0d4f8bc2a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107016750>]}
[0m13:46:25.757799 [debug] [MainThread]: On master: ROLLBACK
[0m13:46:25.758103 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:25.758226 [debug] [MainThread]: On master: BEGIN
[0m13:46:25.758646 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:46:25.758799 [debug] [MainThread]: On master: COMMIT
[0m13:46:25.758918 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:25.759030 [debug] [MainThread]: On master: COMMIT
[0m13:46:25.759258 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:46:25.759382 [debug] [MainThread]: On master: Close
[0m13:46:25.760833 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:46:25.761065 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m13:46:25.761282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710)
[0m13:46:25.761442 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:46:25.770209 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:46:25.770728 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:46:25.780431 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:46:25.781054 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:46:25.781234 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m13:46:25.781563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:25.789358 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:46:25.789686 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:46:25.792020 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dbt_db"."schema_db"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:46:25.799373 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "schema_db.my_first_dbt_model" does not exist
LINE 17: from "dbt_db"."schema_db"."my_first_dbt_model"
              ^

[0m13:46:25.799702 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m13:46:25.800355 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m13:46:25.817281 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_first_dbt_model" does not exist
  LINE 17: from "dbt_db"."schema_db"."my_first_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m13:46:25.817741 [error] [Thread-1 (]: 1 of 4 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.06s]
[0m13:46:25.818037 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:46:25.818225 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:46:25.819434 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m13:46:25.820226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778)
[0m13:46:25.818895 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_first_dbt_model" does not exist
  LINE 17: from "dbt_db"."schema_db"."my_first_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql.
[0m13:46:25.820692 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:46:25.825495 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:46:25.826084 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:46:25.827177 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:46:25.827585 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:46:25.827744 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m13:46:25.827886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:25.838448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:46:25.838820 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:46:25.839014 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dbt_db"."schema_db"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:46:25.839710 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "schema_db.my_second_dbt_model" does not exist
LINE 17: from "dbt_db"."schema_db"."my_second_dbt_model"
              ^

[0m13:46:25.840054 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m13:46:25.840479 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m13:46:25.842675 [debug] [Thread-1 (]: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_second_dbt_model" does not exist
  LINE 17: from "dbt_db"."schema_db"."my_second_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m13:46:25.842970 [error] [Thread-1 (]: 2 of 4 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.02s]
[0m13:46:25.843222 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:46:25.843512 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m13:46:25.843872 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_second_dbt_model" does not exist
  LINE 17: from "dbt_db"."schema_db"."my_second_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/not_null_my_second_dbt_model_id.sql.
[0m13:46:25.844081 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m13:46:25.844443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778, now test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321)
[0m13:46:25.844670 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m13:46:25.848534 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:46:25.849103 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m13:46:25.850741 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:46:25.851251 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:46:25.851427 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m13:46:25.851578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:25.857107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:46:25.857416 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:46:25.857635 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt_db"."schema_db"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:46:25.858201 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "schema_db.my_first_dbt_model" does not exist
LINE 18: from "dbt_db"."schema_db"."my_first_dbt_model"
              ^

[0m13:46:25.858558 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m13:46:25.859029 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:46:25.861034 [debug] [Thread-1 (]: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_first_dbt_model" does not exist
  LINE 18: from "dbt_db"."schema_db"."my_first_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m13:46:25.861288 [error] [Thread-1 (]: 3 of 4 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 0.02s]
[0m13:46:25.861548 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m13:46:25.861727 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:46:25.862015 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_first_dbt_model" does not exist
  LINE 18: from "dbt_db"."schema_db"."my_first_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/unique_my_first_dbt_model_id.sql.
[0m13:46:25.862255 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m13:46:25.862589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321, now test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:46:25.862809 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:46:25.864820 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:46:25.865292 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:46:25.866305 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:46:25.866630 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:46:25.866784 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m13:46:25.866922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:25.883707 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:46:25.883983 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:46:25.884159 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt_db"."schema_db"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:46:25.884836 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "schema_db.my_second_dbt_model" does not exist
LINE 18: from "dbt_db"."schema_db"."my_second_dbt_model"
              ^

[0m13:46:25.885149 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m13:46:25.885574 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m13:46:25.887609 [debug] [Thread-1 (]: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_second_dbt_model" does not exist
  LINE 18: from "dbt_db"."schema_db"."my_second_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m13:46:25.887858 [error] [Thread-1 (]: 4 of 4 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.03s]
[0m13:46:25.888102 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:46:25.888307 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_second_dbt_model" does not exist
  LINE 18: from "dbt_db"."schema_db"."my_second_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/unique_my_second_dbt_model_id.sql.
[0m13:46:25.889226 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:25.889524 [debug] [MainThread]: On master: BEGIN
[0m13:46:25.889692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:25.905217 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m13:46:25.905574 [debug] [MainThread]: On master: COMMIT
[0m13:46:25.905751 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:25.905879 [debug] [MainThread]: On master: COMMIT
[0m13:46:25.911599 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m13:46:25.911889 [debug] [MainThread]: On master: Close
[0m13:46:25.912168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:25.912302 [debug] [MainThread]: Connection 'test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:46:25.912508 [info ] [MainThread]: 
[0m13:46:25.912687 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m13:46:25.913266 [debug] [MainThread]: Command end result
[0m13:46:25.925178 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:46:25.926532 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:46:25.931600 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m13:46:25.931820 [info ] [MainThread]: 
[0m13:46:25.932057 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:46:25.932333 [info ] [MainThread]: 
[0m13:46:25.932527 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_first_dbt_model" does not exist
  LINE 17: from "dbt_db"."schema_db"."my_first_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m13:46:25.932667 [info ] [MainThread]: 
[0m13:46:25.932819 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_second_dbt_model" does not exist
  LINE 17: from "dbt_db"."schema_db"."my_second_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m13:46:25.932949 [info ] [MainThread]: 
[0m13:46:25.933090 [error] [MainThread]:   Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_first_dbt_model" does not exist
  LINE 18: from "dbt_db"."schema_db"."my_first_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m13:46:25.933208 [info ] [MainThread]: 
[0m13:46:25.933355 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  relation "schema_db.my_second_dbt_model" does not exist
  LINE 18: from "dbt_db"."schema_db"."my_second_dbt_model"
                ^
  compiled code at target/run/my_dbt_postgres_project/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m13:46:25.933479 [info ] [MainThread]: 
[0m13:46:25.933672 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m13:46:25.934681 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.646965, "process_in_blocks": "0", "process_kernel_time": 0.173263, "process_mem_max_rss": "128024576", "process_out_blocks": "0", "process_user_time": 0.995955}
[0m13:46:25.934949 [debug] [MainThread]: Command `dbt test` failed at 13:46:25.934902 after 0.65 seconds
[0m13:46:25.935150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658bd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722caa0>]}
[0m13:46:25.935334 [debug] [MainThread]: Flushing usage events
[0m13:46:26.525875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:01.599677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d46120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed3b10>]}


============================== 13:49:01.603566 | 40f78ec0-9164-4590-b728-4f4da61ecd95 ==============================
[0m13:49:01.603566 [info ] [MainThread]: Running with dbt=1.9.8
[0m13:49:01.604022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'profiles_dir': '/Users/maha/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select country_codes', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:49:01.711570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40f78ec0-9164-4590-b728-4f4da61ecd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106118e90>]}
[0m13:49:01.744673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40f78ec0-9164-4590-b728-4f4da61ecd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4b460>]}
[0m13:49:01.745570 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:49:01.818182 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m13:49:01.898614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:49:01.899003 [debug] [MainThread]: Partial parsing: updated file: my_dbt_postgres_project://tests/Country_Code_Test.yml
[0m13:49:01.999315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40f78ec0-9164-4590-b728-4f4da61ecd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc6050>]}
[0m13:49:02.039043 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:49:02.040824 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:49:02.056948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40f78ec0-9164-4590-b728-4f4da61ecd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110646b70>]}
[0m13:49:02.057203 [info ] [MainThread]: Found 2 models, 7 data tests, 1 seed, 433 macros
[0m13:49:02.057374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40f78ec0-9164-4590-b728-4f4da61ecd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105fb930>]}
[0m13:49:02.058199 [info ] [MainThread]: 
[0m13:49:02.058369 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:02.058498 [info ] [MainThread]: 
[0m13:49:02.058727 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:49:02.060825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_schema_db'
[0m13:49:02.093119 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m13:49:02.093373 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m13:49:02.093513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:02.111319 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m13:49:02.111645 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m13:49:02.111813 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m13:49:02.116037 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:49:02.116852 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m13:49:02.117230 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m13:49:02.120278 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:02.120507 [debug] [MainThread]: On master: BEGIN
[0m13:49:02.120634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:02.126710 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:49:02.126941 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:02.127118 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:49:02.138124 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m13:49:02.138968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40f78ec0-9164-4590-b728-4f4da61ecd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11136cae0>]}
[0m13:49:02.139202 [debug] [MainThread]: On master: ROLLBACK
[0m13:49:02.139556 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:02.139765 [debug] [MainThread]: On master: BEGIN
[0m13:49:02.140426 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:49:02.140626 [debug] [MainThread]: On master: COMMIT
[0m13:49:02.140771 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:02.140913 [debug] [MainThread]: On master: COMMIT
[0m13:49:02.141172 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:49:02.141309 [debug] [MainThread]: On master: Close
[0m13:49:02.142841 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m13:49:02.143047 [info ] [Thread-1 (]: 1 of 3 START test not_null_country_codes_country_code .......................... [RUN]
[0m13:49:02.143261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea)
[0m13:49:02.143416 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m13:49:02.152598 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea"
[0m13:49:02.153476 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m13:49:02.163009 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea"
[0m13:49:02.163822 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea"
[0m13:49:02.164001 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea: BEGIN
[0m13:49:02.164143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:02.199625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m13:49:02.200114 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea"
[0m13:49:02.200298 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_code
from "dbt_db"."schema_db"."country_codes"
where country_code is null



  
  
      
    ) dbt_internal_test
[0m13:49:02.204953 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:49:02.207918 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea: ROLLBACK
[0m13:49:02.208414 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea: Close
[0m13:49:02.208764 [info ] [Thread-1 (]: 1 of 3 PASS not_null_country_codes_country_code ................................ [[32mPASS[0m in 0.07s]
[0m13:49:02.209030 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m13:49:02.209207 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m13:49:02.209363 [info ] [Thread-1 (]: 2 of 3 START test not_null_country_codes_country_name .......................... [RUN]
[0m13:49:02.209690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea, now test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b)
[0m13:49:02.209895 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m13:49:02.212487 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b"
[0m13:49:02.213113 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m13:49:02.214179 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b"
[0m13:49:02.214535 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b"
[0m13:49:02.214693 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b: BEGIN
[0m13:49:02.214834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:02.219657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:49:02.219900 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b"
[0m13:49:02.220068 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_name
from "dbt_db"."schema_db"."country_codes"
where country_name is null



  
  
      
    ) dbt_internal_test
[0m13:49:02.220948 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:49:02.221745 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b: ROLLBACK
[0m13:49:02.222054 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b: Close
[0m13:49:02.222578 [info ] [Thread-1 (]: 2 of 3 PASS not_null_country_codes_country_name ................................ [[32mPASS[0m in 0.01s]
[0m13:49:02.222867 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m13:49:02.223055 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m13:49:02.223216 [info ] [Thread-1 (]: 3 of 3 START test unique_country_codes_country_code ............................ [RUN]
[0m13:49:02.223518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b, now test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f)
[0m13:49:02.223827 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m13:49:02.227737 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f"
[0m13:49:02.228268 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m13:49:02.229784 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f"
[0m13:49:02.230272 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f"
[0m13:49:02.230448 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f: BEGIN
[0m13:49:02.230592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:02.242304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:49:02.242582 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f"
[0m13:49:02.242896 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    country_code as unique_field,
    count(*) as n_records

from "dbt_db"."schema_db"."country_codes"
where country_code is not null
group by country_code
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:49:02.244793 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:49:02.245770 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f: ROLLBACK
[0m13:49:02.246178 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f: Close
[0m13:49:02.246958 [info ] [Thread-1 (]: 3 of 3 PASS unique_country_codes_country_code .................................. [[32mPASS[0m in 0.02s]
[0m13:49:02.247263 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m13:49:02.247940 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:02.248088 [debug] [MainThread]: On master: BEGIN
[0m13:49:02.248208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:02.253064 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:49:02.253385 [debug] [MainThread]: On master: COMMIT
[0m13:49:02.253559 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:02.253815 [debug] [MainThread]: On master: COMMIT
[0m13:49:02.254106 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:49:02.254318 [debug] [MainThread]: On master: Close
[0m13:49:02.254560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:02.254691 [debug] [MainThread]: Connection 'test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f' was properly closed.
[0m13:49:02.254827 [info ] [MainThread]: 
[0m13:49:02.254972 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m13:49:02.255416 [debug] [MainThread]: Command end result
[0m13:49:02.267081 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m13:49:02.268516 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m13:49:02.271744 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m13:49:02.271918 [info ] [MainThread]: 
[0m13:49:02.272109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:02.272427 [info ] [MainThread]: 
[0m13:49:02.272585 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:49:02.273860 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.72456163, "process_in_blocks": "0", "process_kernel_time": 0.199126, "process_mem_max_rss": "129646592", "process_out_blocks": "0", "process_user_time": 1.07084}
[0m13:49:02.274129 [debug] [MainThread]: Command `dbt test` succeeded at 13:49:02.274079 after 0.72 seconds
[0m13:49:02.274407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111355230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111354e10>]}
[0m13:49:02.274757 [debug] [MainThread]: Flushing usage events
[0m13:49:02.976343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:22.132442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f76120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d03d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d03b10>]}


============================== 15:16:22.136213 | 5231815a-5a0f-469b-9e48-b586b8d4b09a ==============================
[0m15:16:22.136213 [info ] [MainThread]: Running with dbt=1.9.8
[0m15:16:22.136567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/maha/.dbt', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:16:22.293973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5231815a-5a0f-469b-9e48-b586b8d4b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424ce90>]}
[0m15:16:22.325617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5231815a-5a0f-469b-9e48-b586b8d4b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b7b460>]}
[0m15:16:22.326438 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:16:22.371604 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m15:16:22.453221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:16:22.453654 [debug] [MainThread]: Partial parsing: updated file: my_dbt_postgres_project://seeds/country_codes.csv
[0m15:16:22.619820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5231815a-5a0f-469b-9e48-b586b8d4b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594ec50>]}
[0m15:16:22.655926 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:16:22.657761 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:16:22.669690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5231815a-5a0f-469b-9e48-b586b8d4b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105206f30>]}
[0m15:16:22.669937 [info ] [MainThread]: Found 2 models, 7 data tests, 1 seed, 433 macros
[0m15:16:22.670103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5231815a-5a0f-469b-9e48-b586b8d4b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c37770>]}
[0m15:16:22.670980 [info ] [MainThread]: 
[0m15:16:22.671146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:16:22.671272 [info ] [MainThread]: 
[0m15:16:22.671500 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:16:22.671911 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m15:16:22.721897 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m15:16:22.722186 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m15:16:22.722338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:22.765488 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.043 seconds
[0m15:16:22.766724 [debug] [ThreadPool]: On list_dbt_db: Close
[0m15:16:22.771161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_schema_db)
[0m15:16:22.774396 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:16:22.774628 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m15:16:22.774752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:22.781274 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m15:16:22.781502 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:16:22.781652 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m15:16:22.788367 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:16:22.789172 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m15:16:22.789546 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m15:16:22.792004 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:22.792210 [debug] [MainThread]: On master: BEGIN
[0m15:16:22.792342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:22.797571 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:16:22.797746 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:22.797949 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:16:22.808637 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:16:22.809292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5231815a-5a0f-469b-9e48-b586b8d4b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b4d4a0>]}
[0m15:16:22.809540 [debug] [MainThread]: On master: ROLLBACK
[0m15:16:22.809858 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:22.809989 [debug] [MainThread]: On master: BEGIN
[0m15:16:22.810428 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:16:22.810565 [debug] [MainThread]: On master: COMMIT
[0m15:16:22.810685 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:22.810801 [debug] [MainThread]: On master: COMMIT
[0m15:16:22.811583 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:16:22.811709 [debug] [MainThread]: On master: Close
[0m15:16:22.813217 [debug] [Thread-1 (]: Began running node seed.my_dbt_postgres_project.country_codes
[0m15:16:22.813511 [info ] [Thread-1 (]: 1 of 1 START seed file schema_db.country_codes ................................. [RUN]
[0m15:16:22.813834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now seed.my_dbt_postgres_project.country_codes)
[0m15:16:22.814112 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_postgres_project.country_codes
[0m15:16:22.814314 [debug] [Thread-1 (]: Began executing node seed.my_dbt_postgres_project.country_codes
[0m15:16:22.830567 [debug] [Thread-1 (]: Applying DROP to: "dbt_db"."schema_db"."country_codes"
[0m15:16:22.834211 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.country_codes"
[0m15:16:22.834476 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "seed.my_dbt_postgres_project.country_codes"} */
drop table if exists "dbt_db"."schema_db"."country_codes" cascade
[0m15:16:22.834642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:22.843590 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m15:16:22.847659 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.country_codes"
[0m15:16:22.847925 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: BEGIN
[0m15:16:22.848346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m15:16:22.848576 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.country_codes"
[0m15:16:22.848744 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "seed.my_dbt_postgres_project.country_codes"} */

    create table "dbt_db"."schema_db"."country_codes" ("country_name" text,"country_code" text)
  
[0m15:16:22.857511 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.009 seconds
[0m15:16:22.870650 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.country_codes"
[0m15:16:22.870919 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: 
          insert into "dbt_db"."schema_db"."country_codes" ("country_name", "country_code") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m15:16:22.872499 [debug] [Thread-1 (]: SQL status: INSERT 0 41 in 0.001 seconds
[0m15:16:22.875293 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_dbt_postgres_project.country_codes"
[0m15:16:22.888110 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: COMMIT
[0m15:16:22.888497 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.country_codes"
[0m15:16:22.888695 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: COMMIT
[0m15:16:22.891378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:16:22.892579 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: Close
[0m15:16:22.893846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5231815a-5a0f-469b-9e48-b586b8d4b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d02450>]}
[0m15:16:22.894154 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file schema_db.country_codes ............................. [[32mCREATE 41[0m in 0.08s]
[0m15:16:22.894480 [debug] [Thread-1 (]: Finished running node seed.my_dbt_postgres_project.country_codes
[0m15:16:22.895223 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:22.895375 [debug] [MainThread]: On master: BEGIN
[0m15:16:22.895491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:16:22.901684 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:16:22.902092 [debug] [MainThread]: On master: COMMIT
[0m15:16:22.902298 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:22.902429 [debug] [MainThread]: On master: COMMIT
[0m15:16:22.902754 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:16:22.902982 [debug] [MainThread]: On master: Close
[0m15:16:22.903228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:22.903369 [debug] [MainThread]: Connection 'seed.my_dbt_postgres_project.country_codes' was properly closed.
[0m15:16:22.903501 [info ] [MainThread]: 
[0m15:16:22.903646 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m15:16:22.903965 [debug] [MainThread]: Command end result
[0m15:16:22.961087 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:16:22.962089 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:16:22.964809 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m15:16:22.964963 [info ] [MainThread]: 
[0m15:16:22.965147 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:22.965283 [info ] [MainThread]: 
[0m15:16:22.965426 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:16:22.966729 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.880159, "process_in_blocks": "0", "process_kernel_time": 0.206186, "process_mem_max_rss": "130088960", "process_out_blocks": "0", "process_user_time": 1.17578}
[0m15:16:22.967027 [debug] [MainThread]: Command `dbt seed` succeeded at 15:16:22.966975 after 0.88 seconds
[0m15:16:22.967224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c72d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb68f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb67b0>]}
[0m15:16:22.967410 [debug] [MainThread]: Flushing usage events
[0m15:16:23.823892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:37.570408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a46120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd3b10>]}


============================== 15:23:37.574249 | 98aebeae-981c-4846-acbe-e7bc1bfb7838 ==============================
[0m15:23:37.574249 [info ] [MainThread]: Running with dbt=1.9.8
[0m15:23:37.574637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select country_codes', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:37.676747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98aebeae-981c-4846-acbe-e7bc1bfb7838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d20e90>]}
[0m15:23:37.709576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98aebeae-981c-4846-acbe-e7bc1bfb7838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4b460>]}
[0m15:23:37.710474 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:23:37.757345 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m15:23:37.838026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:37.838332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:37.862683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98aebeae-981c-4846-acbe-e7bc1bfb7838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105c9850>]}
[0m15:23:37.900319 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:23:37.902106 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:23:37.918918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98aebeae-981c-4846-acbe-e7bc1bfb7838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11172cc80>]}
[0m15:23:37.919207 [info ] [MainThread]: Found 2 models, 7 data tests, 1 seed, 433 macros
[0m15:23:37.919381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98aebeae-981c-4846-acbe-e7bc1bfb7838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107d5c50>]}
[0m15:23:37.920273 [info ] [MainThread]: 
[0m15:23:37.920488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:37.920625 [info ] [MainThread]: 
[0m15:23:37.920883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:37.922863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_schema_db'
[0m15:23:37.960256 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:23:37.960729 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m15:23:37.960932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:38.012715 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m15:23:38.013028 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:23:38.013190 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m15:23:38.022077 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m15:23:38.022948 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m15:23:38.023286 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m15:23:38.025783 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:38.025956 [debug] [MainThread]: On master: BEGIN
[0m15:23:38.026083 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:38.030439 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:23:38.030697 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:38.030904 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:38.039117 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m15:23:38.039787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98aebeae-981c-4846-acbe-e7bc1bfb7838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119168f0>]}
[0m15:23:38.040021 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:38.040327 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:38.040447 [debug] [MainThread]: On master: BEGIN
[0m15:23:38.040897 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:23:38.041072 [debug] [MainThread]: On master: COMMIT
[0m15:23:38.041208 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:38.041326 [debug] [MainThread]: On master: COMMIT
[0m15:23:38.041570 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:38.041725 [debug] [MainThread]: On master: Close
[0m15:23:38.043231 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m15:23:38.043467 [info ] [Thread-1 (]: 1 of 3 START test not_null_country_codes_country_code .......................... [RUN]
[0m15:23:38.043709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea)
[0m15:23:38.043880 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m15:23:38.052485 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea"
[0m15:23:38.053311 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m15:23:38.065129 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea"
[0m15:23:38.065855 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea"
[0m15:23:38.066280 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea: BEGIN
[0m15:23:38.066490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:38.071774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:23:38.072000 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea"
[0m15:23:38.072176 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_code
from "dbt_db"."schema_db"."country_codes"
where country_code is null



  
  
      
    ) dbt_internal_test
[0m15:23:38.073200 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:23:38.075590 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea: ROLLBACK
[0m15:23:38.076242 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea: Close
[0m15:23:38.076586 [info ] [Thread-1 (]: 1 of 3 PASS not_null_country_codes_country_code ................................ [[32mPASS[0m in 0.03s]
[0m15:23:38.076866 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m15:23:38.077047 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m15:23:38.077202 [info ] [Thread-1 (]: 2 of 3 START test not_null_country_codes_country_name .......................... [RUN]
[0m15:23:38.077391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea, now test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b)
[0m15:23:38.077546 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m15:23:38.080107 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b"
[0m15:23:38.080720 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m15:23:38.081814 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b"
[0m15:23:38.082159 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b"
[0m15:23:38.082320 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b: BEGIN
[0m15:23:38.082468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:38.087723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:23:38.087982 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b"
[0m15:23:38.088160 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_name
from "dbt_db"."schema_db"."country_codes"
where country_name is null



  
  
      
    ) dbt_internal_test
[0m15:23:38.089119 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:23:38.089923 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b: ROLLBACK
[0m15:23:38.090309 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b: Close
[0m15:23:38.090762 [info ] [Thread-1 (]: 2 of 3 PASS not_null_country_codes_country_name ................................ [[32mPASS[0m in 0.01s]
[0m15:23:38.091056 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m15:23:38.091245 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m15:23:38.091520 [info ] [Thread-1 (]: 3 of 3 START test unique_country_codes_country_code ............................ [RUN]
[0m15:23:38.091849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b, now test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f)
[0m15:23:38.092036 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m15:23:38.096582 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f"
[0m15:23:38.097235 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m15:23:38.098790 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f"
[0m15:23:38.099436 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f"
[0m15:23:38.099620 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f: BEGIN
[0m15:23:38.099770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:38.108013 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:23:38.108343 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f"
[0m15:23:38.108993 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    country_code as unique_field,
    count(*) as n_records

from "dbt_db"."schema_db"."country_codes"
where country_code is not null
group by country_code
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:23:38.110735 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:23:38.111592 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f: ROLLBACK
[0m15:23:38.111989 [debug] [Thread-1 (]: On test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f: Close
[0m15:23:38.112496 [info ] [Thread-1 (]: 3 of 3 PASS unique_country_codes_country_code .................................. [[32mPASS[0m in 0.02s]
[0m15:23:38.112778 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m15:23:38.113522 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:38.113769 [debug] [MainThread]: On master: BEGIN
[0m15:23:38.113904 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:38.118390 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:23:38.118607 [debug] [MainThread]: On master: COMMIT
[0m15:23:38.118750 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:38.118874 [debug] [MainThread]: On master: COMMIT
[0m15:23:38.119100 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:38.119360 [debug] [MainThread]: On master: Close
[0m15:23:38.119605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:38.119729 [debug] [MainThread]: Connection 'test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f' was properly closed.
[0m15:23:38.119872 [info ] [MainThread]: 
[0m15:23:38.120020 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m15:23:38.120456 [debug] [MainThread]: Command end result
[0m15:23:38.132126 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:23:38.133206 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:23:38.139023 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m15:23:38.139254 [info ] [MainThread]: 
[0m15:23:38.139444 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:38.139626 [info ] [MainThread]: 
[0m15:23:38.139829 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:23:38.141873 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.62621236, "process_in_blocks": "0", "process_kernel_time": 0.180338, "process_mem_max_rss": "131153920", "process_out_blocks": "0", "process_user_time": 0.999229}
[0m15:23:38.142221 [debug] [MainThread]: Command `dbt test` succeeded at 15:23:38.142170 after 0.63 seconds
[0m15:23:38.142432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a7b70>]}
[0m15:23:38.142619 [debug] [MainThread]: Flushing usage events
[0m15:23:38.830018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:16.439958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ba120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108647d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108647b10>]}


============================== 15:50:16.444335 | 21052a9d-cd02-4213-b9fb-ebb33ca2eb63 ==============================
[0m15:50:16.444335 [info ] [MainThread]: Running with dbt=1.9.8
[0m15:50:16.444768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:50:16.584374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21052a9d-cd02-4213-b9fb-ebb33ca2eb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b90e90>]}
[0m15:50:16.617532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21052a9d-cd02-4213-b9fb-ebb33ca2eb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084bf460>]}
[0m15:50:16.618424 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:50:16.667176 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m15:50:16.747483 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m15:50:16.747856 [debug] [MainThread]: Partial parsing: added file: my_dbt_postgres_project://snapshots/country_code_snapshot.sql
[0m15:50:16.748059 [debug] [MainThread]: Partial parsing: added file: my_dbt_postgres_project://tests/country_code_test.yml
[0m15:50:17.006220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21052a9d-cd02-4213-b9fb-ebb33ca2eb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10929b150>]}
[0m15:50:17.049259 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:50:17.051118 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:50:17.063367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21052a9d-cd02-4213-b9fb-ebb33ca2eb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b48410>]}
[0m15:50:17.063640 [info ] [MainThread]: Found 2 models, 7 data tests, 1 snapshot, 1 seed, 433 macros
[0m15:50:17.063811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21052a9d-cd02-4213-b9fb-ebb33ca2eb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096a75b0>]}
[0m15:50:17.064732 [info ] [MainThread]: 
[0m15:50:17.064906 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:50:17.065033 [info ] [MainThread]: 
[0m15:50:17.065277 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:17.065711 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m15:50:17.184755 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m15:50:17.185023 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m15:50:17.185172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:17.203611 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m15:50:17.204482 [debug] [ThreadPool]: On list_dbt_db: Close
[0m15:50:17.204900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now create_dbt_db_snapshots)
[0m15:50:17.205374 [debug] [ThreadPool]: Creating schema "database: "dbt_db"
schema: "snapshots"
"
[0m15:50:17.208162 [debug] [ThreadPool]: Using postgres connection "create_dbt_db_snapshots"
[0m15:50:17.208384 [debug] [ThreadPool]: On create_dbt_db_snapshots: BEGIN
[0m15:50:17.208515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:17.214603 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m15:50:17.214829 [debug] [ThreadPool]: Using postgres connection "create_dbt_db_snapshots"
[0m15:50:17.214965 [debug] [ThreadPool]: On create_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "create_dbt_db_snapshots"} */
create schema if not exists "snapshots"
[0m15:50:17.216509 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m15:50:17.217026 [debug] [ThreadPool]: On create_dbt_db_snapshots: COMMIT
[0m15:50:17.217179 [debug] [ThreadPool]: Using postgres connection "create_dbt_db_snapshots"
[0m15:50:17.217307 [debug] [ThreadPool]: On create_dbt_db_snapshots: COMMIT
[0m15:50:17.218492 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:50:17.218650 [debug] [ThreadPool]: On create_dbt_db_snapshots: Close
[0m15:50:17.220971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_db_snapshots, now list_dbt_db_schema_db)
[0m15:50:17.223812 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:50:17.224090 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m15:50:17.224273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:17.231517 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:50:17.231726 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:50:17.231870 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m15:50:17.236121 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m15:50:17.237237 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m15:50:17.237660 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m15:50:17.237921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now list_dbt_db_snapshots)
[0m15:50:17.238763 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m15:50:17.238900 [debug] [ThreadPool]: On list_dbt_db_snapshots: BEGIN
[0m15:50:17.239028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:17.244609 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m15:50:17.244799 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m15:50:17.244938 [debug] [ThreadPool]: On list_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:50:17.252509 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m15:50:17.253105 [debug] [ThreadPool]: On list_dbt_db_snapshots: ROLLBACK
[0m15:50:17.253439 [debug] [ThreadPool]: On list_dbt_db_snapshots: Close
[0m15:50:17.255524 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:17.255683 [debug] [MainThread]: On master: BEGIN
[0m15:50:17.255803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:17.261989 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:50:17.262148 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:17.262322 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:17.272292 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:50:17.272878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21052a9d-cd02-4213-b9fb-ebb33ca2eb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10950c390>]}
[0m15:50:17.273097 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:17.273409 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:17.273551 [debug] [MainThread]: On master: BEGIN
[0m15:50:17.274017 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:50:17.274152 [debug] [MainThread]: On master: COMMIT
[0m15:50:17.274497 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:17.274666 [debug] [MainThread]: On master: COMMIT
[0m15:50:17.274983 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:50:17.275165 [debug] [MainThread]: On master: Close
[0m15:50:17.277579 [debug] [Thread-1 (]: Began running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:50:17.277839 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.country_codes_snapshot ......................... [RUN]
[0m15:50:17.278070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_snapshots, now snapshot.my_dbt_postgres_project.country_codes_snapshot)
[0m15:50:17.278240 [debug] [Thread-1 (]: Began compiling node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:50:17.282624 [debug] [Thread-1 (]: Began executing node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:50:17.323657 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:50:17.323982 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

SELECT
  country_name,
  country_code,
  updated_at
FROM
  "dbt_db"."schema_db"."country_codes"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:50:17.324167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:17.330537 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 22:   updated_at
           ^

[0m15:50:17.330836 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: Close
[0m15:50:17.337699 [debug] [Thread-1 (]: Database Error in snapshot country_codes_snapshot (snapshots/country_code_snapshot.sql)
  column "updated_at" does not exist
  LINE 22:   updated_at
             ^
[0m15:50:17.338889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21052a9d-cd02-4213-b9fb-ebb33ca2eb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10977e210>]}
[0m15:50:17.339334 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.country_codes_snapshot ..................... [[31mERROR[0m in 0.06s]
[0m15:50:17.339626 [debug] [Thread-1 (]: Finished running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:50:17.339887 [debug] [Thread-4 (]: Marking all children of 'snapshot.my_dbt_postgres_project.country_codes_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot country_codes_snapshot (snapshots/country_code_snapshot.sql)
  column "updated_at" does not exist
  LINE 22:   updated_at
             ^.
[0m15:50:17.340817 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:17.341021 [debug] [MainThread]: On master: BEGIN
[0m15:50:17.341216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:17.349115 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:50:17.349393 [debug] [MainThread]: On master: COMMIT
[0m15:50:17.349552 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:17.349678 [debug] [MainThread]: On master: COMMIT
[0m15:50:17.350061 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:50:17.350238 [debug] [MainThread]: On master: Close
[0m15:50:17.350460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:17.350589 [debug] [MainThread]: Connection 'snapshot.my_dbt_postgres_project.country_codes_snapshot' was properly closed.
[0m15:50:17.350719 [info ] [MainThread]: 
[0m15:50:17.350859 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m15:50:17.351157 [debug] [MainThread]: Command end result
[0m15:50:17.363674 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:50:17.364826 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:50:17.369786 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m15:50:17.370015 [info ] [MainThread]: 
[0m15:50:17.370204 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:50:17.370353 [info ] [MainThread]: 
[0m15:50:17.370521 [error] [MainThread]:   Database Error in snapshot country_codes_snapshot (snapshots/country_code_snapshot.sql)
  column "updated_at" does not exist
  LINE 22:   updated_at
             ^
[0m15:50:17.370929 [info ] [MainThread]: 
[0m15:50:17.371237 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:50:17.372895 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.975382, "process_in_blocks": "0", "process_kernel_time": 0.222491, "process_mem_max_rss": "133038080", "process_out_blocks": "0", "process_user_time": 1.311934}
[0m15:50:17.373253 [debug] [MainThread]: Command `dbt snapshot` failed at 15:50:17.373172 after 0.98 seconds
[0m15:50:17.373476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109510100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10953c4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10953c410>]}
[0m15:50:17.373709 [debug] [MainThread]: Flushing usage events
[0m15:50:20.889807 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:53:30.560625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d3b10>]}


============================== 15:53:30.564422 | e087c4cf-c00a-4fd6-a4ce-aca18c9895e5 ==============================
[0m15:53:30.564422 [info ] [MainThread]: Running with dbt=1.9.8
[0m15:53:30.564764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m15:53:30.677281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e087c4cf-c00a-4fd6-a4ce-aca18c9895e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d20e90>]}
[0m15:53:30.711819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e087c4cf-c00a-4fd6-a4ce-aca18c9895e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614b460>]}
[0m15:53:30.712720 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:53:30.761721 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m15:53:30.849393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:53:30.849773 [debug] [MainThread]: Partial parsing: updated file: my_dbt_postgres_project://snapshots/country_code_snapshot.sql
[0m15:53:30.979922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e087c4cf-c00a-4fd6-a4ce-aca18c9895e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ce050>]}
[0m15:53:31.025270 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:53:31.027021 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:53:31.038850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e087c4cf-c00a-4fd6-a4ce-aca18c9895e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e07890>]}
[0m15:53:31.039104 [info ] [MainThread]: Found 2 models, 7 data tests, 1 seed, 1 snapshot, 433 macros
[0m15:53:31.039269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e087c4cf-c00a-4fd6-a4ce-aca18c9895e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b9390>]}
[0m15:53:31.040176 [info ] [MainThread]: 
[0m15:53:31.040342 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:53:31.040464 [info ] [MainThread]: 
[0m15:53:31.040691 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:53:31.041124 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m15:53:31.075010 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m15:53:31.075315 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m15:53:31.075474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:31.128645 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.053 seconds
[0m15:53:31.137987 [debug] [ThreadPool]: On list_dbt_db: Close
[0m15:53:31.140901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_snapshots)
[0m15:53:31.147894 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m15:53:31.148155 [debug] [ThreadPool]: On list_dbt_db_snapshots: BEGIN
[0m15:53:31.148289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:31.155708 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:53:31.155972 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m15:53:31.156125 [debug] [ThreadPool]: On list_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:53:31.160360 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m15:53:31.161073 [debug] [ThreadPool]: On list_dbt_db_snapshots: ROLLBACK
[0m15:53:31.161425 [debug] [ThreadPool]: On list_dbt_db_snapshots: Close
[0m15:53:31.161719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_snapshots, now list_dbt_db_schema_db)
[0m15:53:31.162723 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:53:31.162865 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m15:53:31.162979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:31.168123 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:53:31.168306 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:53:31.168451 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m15:53:31.172222 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m15:53:31.172843 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m15:53:31.173167 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m15:53:31.175984 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:31.176207 [debug] [MainThread]: On master: BEGIN
[0m15:53:31.176341 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:53:31.182039 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:53:31.182249 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:31.182479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:53:31.193408 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m15:53:31.194241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e087c4cf-c00a-4fd6-a4ce-aca18c9895e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e4bb0>]}
[0m15:53:31.194532 [debug] [MainThread]: On master: ROLLBACK
[0m15:53:31.194884 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:31.195088 [debug] [MainThread]: On master: BEGIN
[0m15:53:31.195647 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:53:31.195847 [debug] [MainThread]: On master: COMMIT
[0m15:53:31.196017 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:31.196147 [debug] [MainThread]: On master: COMMIT
[0m15:53:31.196436 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:53:31.196600 [debug] [MainThread]: On master: Close
[0m15:53:31.198863 [debug] [Thread-1 (]: Began running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:53:31.199240 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.country_codes_snapshot ......................... [RUN]
[0m15:53:31.199491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now snapshot.my_dbt_postgres_project.country_codes_snapshot)
[0m15:53:31.199664 [debug] [Thread-1 (]: Began compiling node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:53:31.203682 [debug] [Thread-1 (]: Began executing node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:53:31.245075 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:53:31.245342 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

SELECT
  country_name,
  country_code,
  updated_at
FROM
  dbt_db.dbt_schema.country_codes
  --"dbt_db"."schema_db"."country_codes"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:53:31.245642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:31.255342 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_schema.country_codes" does not exist
LINE 24:   dbt_db.dbt_schema.country_codes
           ^

[0m15:53:31.255664 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: Close
[0m15:53:31.263334 [debug] [Thread-1 (]: Database Error in snapshot country_codes_snapshot (snapshots/country_code_snapshot.sql)
  relation "dbt_schema.country_codes" does not exist
  LINE 24:   dbt_db.dbt_schema.country_codes
             ^
[0m15:53:31.264479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e087c4cf-c00a-4fd6-a4ce-aca18c9895e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075fde50>]}
[0m15:53:31.264950 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.country_codes_snapshot ..................... [[31mERROR[0m in 0.06s]
[0m15:53:31.265265 [debug] [Thread-1 (]: Finished running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:53:31.265534 [debug] [Thread-4 (]: Marking all children of 'snapshot.my_dbt_postgres_project.country_codes_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot country_codes_snapshot (snapshots/country_code_snapshot.sql)
  relation "dbt_schema.country_codes" does not exist
  LINE 24:   dbt_db.dbt_schema.country_codes
             ^.
[0m15:53:31.266642 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:31.266836 [debug] [MainThread]: On master: BEGIN
[0m15:53:31.266965 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:53:31.273903 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:53:31.274096 [debug] [MainThread]: On master: COMMIT
[0m15:53:31.274256 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:31.274381 [debug] [MainThread]: On master: COMMIT
[0m15:53:31.274693 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:53:31.274816 [debug] [MainThread]: On master: Close
[0m15:53:31.274993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:31.275109 [debug] [MainThread]: Connection 'snapshot.my_dbt_postgres_project.country_codes_snapshot' was properly closed.
[0m15:53:31.275236 [info ] [MainThread]: 
[0m15:53:31.275434 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m15:53:31.275870 [debug] [MainThread]: Command end result
[0m15:53:31.288108 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:53:31.289147 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:53:31.292752 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m15:53:31.292951 [info ] [MainThread]: 
[0m15:53:31.293142 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:53:31.293291 [info ] [MainThread]: 
[0m15:53:31.293462 [error] [MainThread]:   Database Error in snapshot country_codes_snapshot (snapshots/country_code_snapshot.sql)
  relation "dbt_schema.country_codes" does not exist
  LINE 24:   dbt_db.dbt_schema.country_codes
             ^
[0m15:53:31.293588 [info ] [MainThread]: 
[0m15:53:31.293728 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:53:31.295444 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.7847611, "process_in_blocks": "0", "process_kernel_time": 0.212034, "process_mem_max_rss": "130744320", "process_out_blocks": "0", "process_user_time": 1.128536}
[0m15:53:31.295751 [debug] [MainThread]: Command `dbt snapshot` failed at 15:53:31.295701 after 0.79 seconds
[0m15:53:31.295977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740a8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b1950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b2030>]}
[0m15:53:31.296263 [debug] [MainThread]: Flushing usage events
[0m15:53:31.982779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:54:33.640957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd3b10>]}


============================== 15:54:33.644843 | f0f6c6a0-29fa-4a51-a552-697723580671 ==============================
[0m15:54:33.644843 [info ] [MainThread]: Running with dbt=1.9.8
[0m15:54:33.645363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/maha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:54:33.754263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0f6c6a0-29fa-4a51-a552-697723580671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e20e90>]}
[0m15:54:33.787742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0f6c6a0-29fa-4a51-a552-697723580671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794b460>]}
[0m15:54:33.788596 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:54:33.840241 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m15:54:33.928200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:54:33.928690 [debug] [MainThread]: Partial parsing: updated file: my_dbt_postgres_project://snapshots/country_code_snapshot.sql
[0m15:54:34.057353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0f6c6a0-29fa-4a51-a552-697723580671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c9f50>]}
[0m15:54:34.102444 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:54:34.104296 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:54:34.115889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0f6c6a0-29fa-4a51-a552-697723580671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5f890>]}
[0m15:54:34.116165 [info ] [MainThread]: Found 2 models, 7 data tests, 1 seed, 1 snapshot, 433 macros
[0m15:54:34.116330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0f6c6a0-29fa-4a51-a552-697723580671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807fa10>]}
[0m15:54:34.117236 [info ] [MainThread]: 
[0m15:54:34.117415 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:54:34.117537 [info ] [MainThread]: 
[0m15:54:34.117770 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:54:34.118191 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m15:54:34.150207 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m15:54:34.150483 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m15:54:34.150762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:34.179698 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.029 seconds
[0m15:54:34.180811 [debug] [ThreadPool]: On list_dbt_db: Close
[0m15:54:34.184003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_snapshots)
[0m15:54:34.187230 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m15:54:34.187461 [debug] [ThreadPool]: On list_dbt_db_snapshots: BEGIN
[0m15:54:34.187600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:34.219376 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m15:54:34.219659 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m15:54:34.219819 [debug] [ThreadPool]: On list_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:54:34.228408 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m15:54:34.229585 [debug] [ThreadPool]: On list_dbt_db_snapshots: ROLLBACK
[0m15:54:34.230024 [debug] [ThreadPool]: On list_dbt_db_snapshots: Close
[0m15:54:34.230346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_snapshots, now list_dbt_db_schema_db)
[0m15:54:34.231210 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:54:34.231351 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m15:54:34.231469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:34.239846 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:54:34.240078 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:54:34.240228 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m15:54:34.243705 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:54:34.244564 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m15:54:34.247264 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m15:54:34.250179 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:34.250363 [debug] [MainThread]: On master: BEGIN
[0m15:54:34.250487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:54:34.253731 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:54:34.253954 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:34.254142 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:54:34.257920 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m15:54:34.258640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0f6c6a0-29fa-4a51-a552-697723580671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a358b0>]}
[0m15:54:34.258898 [debug] [MainThread]: On master: ROLLBACK
[0m15:54:34.259219 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:34.259355 [debug] [MainThread]: On master: BEGIN
[0m15:54:34.259765 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:54:34.259898 [debug] [MainThread]: On master: COMMIT
[0m15:54:34.260019 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:34.260137 [debug] [MainThread]: On master: COMMIT
[0m15:54:34.260375 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:54:34.260500 [debug] [MainThread]: On master: Close
[0m15:54:34.262739 [debug] [Thread-1 (]: Began running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:54:34.263032 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.country_codes_snapshot ......................... [RUN]
[0m15:54:34.263255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now snapshot.my_dbt_postgres_project.country_codes_snapshot)
[0m15:54:34.263419 [debug] [Thread-1 (]: Began compiling node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:54:34.267605 [debug] [Thread-1 (]: Began executing node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:54:34.308661 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:54:34.308962 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  dbt_db.dbt_schema.country_codes
  --"dbt_db"."schema_db"."country_codes"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:54:34.309147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:34.315171 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_schema.country_codes" does not exist
LINE 24:   dbt_db.dbt_schema.country_codes
           ^

[0m15:54:34.315556 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: Close
[0m15:54:34.322940 [debug] [Thread-1 (]: Database Error in snapshot country_codes_snapshot (snapshots/country_code_snapshot.sql)
  relation "dbt_schema.country_codes" does not exist
  LINE 24:   dbt_db.dbt_schema.country_codes
             ^
[0m15:54:34.324170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0f6c6a0-29fa-4a51-a552-697723580671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108afdfd0>]}
[0m15:54:34.324613 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.country_codes_snapshot ..................... [[31mERROR[0m in 0.06s]
[0m15:54:34.324890 [debug] [Thread-1 (]: Finished running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:54:34.325169 [debug] [Thread-4 (]: Marking all children of 'snapshot.my_dbt_postgres_project.country_codes_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot country_codes_snapshot (snapshots/country_code_snapshot.sql)
  relation "dbt_schema.country_codes" does not exist
  LINE 24:   dbt_db.dbt_schema.country_codes
             ^.
[0m15:54:34.326254 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:34.326439 [debug] [MainThread]: On master: BEGIN
[0m15:54:34.326570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:54:34.332046 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:54:34.332281 [debug] [MainThread]: On master: COMMIT
[0m15:54:34.332490 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:34.332646 [debug] [MainThread]: On master: COMMIT
[0m15:54:34.332904 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:54:34.333113 [debug] [MainThread]: On master: Close
[0m15:54:34.333349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:34.333480 [debug] [MainThread]: Connection 'snapshot.my_dbt_postgres_project.country_codes_snapshot' was properly closed.
[0m15:54:34.333625 [info ] [MainThread]: 
[0m15:54:34.333777 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m15:54:34.334117 [debug] [MainThread]: Command end result
[0m15:54:34.345686 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:54:34.346784 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:54:34.350208 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m15:54:34.350422 [info ] [MainThread]: 
[0m15:54:34.350619 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:54:34.350770 [info ] [MainThread]: 
[0m15:54:34.350946 [error] [MainThread]:   Database Error in snapshot country_codes_snapshot (snapshots/country_code_snapshot.sql)
  relation "dbt_schema.country_codes" does not exist
  LINE 24:   dbt_db.dbt_schema.country_codes
             ^
[0m15:54:34.351073 [info ] [MainThread]: 
[0m15:54:34.351212 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:54:34.352785 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.7588613, "process_in_blocks": "0", "process_kernel_time": 0.186542, "process_mem_max_rss": "131072000", "process_out_blocks": "0", "process_user_time": 1.117337}
[0m15:54:34.353115 [debug] [MainThread]: Command `dbt snapshot` failed at 15:54:34.353060 after 0.76 seconds
[0m15:54:34.353333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108902990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da5ef0>]}
[0m15:54:34.353652 [debug] [MainThread]: Flushing usage events
[0m15:54:34.956444 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:56:22.718523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d3b10>]}


============================== 15:56:22.722570 | edf2db31-448c-499d-a83f-f77a4893370a ==============================
[0m15:56:22.722570 [info ] [MainThread]: Running with dbt=1.9.8
[0m15:56:22.722902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:56:22.832090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edf2db31-448c-499d-a83f-f77a4893370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105220e90>]}
[0m15:56:22.866191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edf2db31-448c-499d-a83f-f77a4893370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4b460>]}
[0m15:56:22.866961 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:56:22.915674 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m15:56:23.002819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:56:23.003260 [debug] [MainThread]: Partial parsing: updated file: my_dbt_postgres_project://snapshots/country_code_snapshot.sql
[0m15:56:23.137539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edf2db31-448c-499d-a83f-f77a4893370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d5f50>]}
[0m15:56:23.183934 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:56:23.185797 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:56:23.197863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edf2db31-448c-499d-a83f-f77a4893370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657f890>]}
[0m15:56:23.198115 [info ] [MainThread]: Found 2 models, 7 data tests, 1 seed, 1 snapshot, 433 macros
[0m15:56:23.198273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edf2db31-448c-499d-a83f-f77a4893370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742fa10>]}
[0m15:56:23.199172 [info ] [MainThread]: 
[0m15:56:23.199339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:56:23.199462 [info ] [MainThread]: 
[0m15:56:23.199698 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:56:23.200104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m15:56:23.232375 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m15:56:23.232669 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m15:56:23.232823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:23.303471 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.071 seconds
[0m15:56:23.304365 [debug] [ThreadPool]: On list_dbt_db: Close
[0m15:56:23.307681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_snapshots)
[0m15:56:23.311501 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m15:56:23.312187 [debug] [ThreadPool]: On list_dbt_db_snapshots: BEGIN
[0m15:56:23.312581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:23.317671 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:56:23.317900 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m15:56:23.318043 [debug] [ThreadPool]: On list_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:56:23.321616 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m15:56:23.322290 [debug] [ThreadPool]: On list_dbt_db_snapshots: ROLLBACK
[0m15:56:23.322570 [debug] [ThreadPool]: On list_dbt_db_snapshots: Close
[0m15:56:23.322817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_snapshots, now list_dbt_db_schema_db)
[0m15:56:23.323787 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:56:23.323981 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m15:56:23.324111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:23.328465 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:56:23.328675 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:56:23.328825 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m15:56:23.334730 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m15:56:23.335353 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m15:56:23.335634 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m15:56:23.338442 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:23.338654 [debug] [MainThread]: On master: BEGIN
[0m15:56:23.338782 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:23.345973 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:56:23.346225 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:23.346418 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:56:23.363352 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m15:56:23.364118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edf2db31-448c-499d-a83f-f77a4893370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107924fc0>]}
[0m15:56:23.364391 [debug] [MainThread]: On master: ROLLBACK
[0m15:56:23.364734 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:23.364874 [debug] [MainThread]: On master: BEGIN
[0m15:56:23.365326 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:56:23.365472 [debug] [MainThread]: On master: COMMIT
[0m15:56:23.365598 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:23.365719 [debug] [MainThread]: On master: COMMIT
[0m15:56:23.365975 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:56:23.366110 [debug] [MainThread]: On master: Close
[0m15:56:23.368465 [debug] [Thread-1 (]: Began running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:56:23.368783 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.country_codes_snapshot ......................... [RUN]
[0m15:56:23.369037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now snapshot.my_dbt_postgres_project.country_codes_snapshot)
[0m15:56:23.369219 [debug] [Thread-1 (]: Began compiling node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:56:23.373552 [debug] [Thread-1 (]: Began executing node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:56:23.414739 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:56:23.415035 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  dbt_db.schema_db.country_codes
  --"dbt_db"."schema_db"."country_codes"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:56:23.415209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:23.421294 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m15:56:23.423000 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:56:23.423191 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:56:23.423667 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:56:23.423929 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:56:23.424511 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:56:23.424679 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: BEGIN
[0m15:56:23.425389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m15:56:23.425551 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:56:23.425708 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      
  
    

  create  table "dbt_db"."snapshots"."country_codes_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  dbt_db.schema_db.country_codes
  --"dbt_db"."schema_db"."country_codes"
    ) sbq



  );
  
  
[0m15:56:23.436354 [debug] [Thread-1 (]: SQL status: SELECT 41 in 0.010 seconds
[0m15:56:23.445908 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: COMMIT
[0m15:56:23.446152 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:56:23.446341 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: COMMIT
[0m15:56:23.447406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:56:23.448397 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: Close
[0m15:56:23.449491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edf2db31-448c-499d-a83f-f77a4893370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107afeb10>]}
[0m15:56:23.449912 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.country_codes_snapshot ......................... [[32mSELECT 41[0m in 0.08s]
[0m15:56:23.450194 [debug] [Thread-1 (]: Finished running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:56:23.450841 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:23.451026 [debug] [MainThread]: On master: BEGIN
[0m15:56:23.451159 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:56:23.456182 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:56:23.456346 [debug] [MainThread]: On master: COMMIT
[0m15:56:23.456488 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:23.456722 [debug] [MainThread]: On master: COMMIT
[0m15:56:23.457027 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:56:23.457189 [debug] [MainThread]: On master: Close
[0m15:56:23.457382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:23.457502 [debug] [MainThread]: Connection 'snapshot.my_dbt_postgres_project.country_codes_snapshot' was properly closed.
[0m15:56:23.457678 [info ] [MainThread]: 
[0m15:56:23.457854 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m15:56:23.458232 [debug] [MainThread]: Command end result
[0m15:56:23.470471 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:56:23.471632 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:56:23.474698 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m15:56:23.474877 [info ] [MainThread]: 
[0m15:56:23.475065 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:56:23.475199 [info ] [MainThread]: 
[0m15:56:23.475525 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:56:23.477159 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.80709857, "process_in_blocks": "0", "process_kernel_time": 0.216542, "process_mem_max_rss": "130646016", "process_out_blocks": "0", "process_user_time": 1.153976}
[0m15:56:23.477583 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:56:23.477531 after 0.81 seconds
[0m15:56:23.477783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107906ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7e3f0>]}
[0m15:56:23.477968 [debug] [MainThread]: Flushing usage events
[0m15:56:24.210020 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:35.730647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107946120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd3b10>]}


============================== 15:58:35.734787 | d993a00c-8911-42fb-a683-00d4eb2ba85d ==============================
[0m15:58:35.734787 [info ] [MainThread]: Running with dbt=1.9.8
[0m15:58:35.735229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/maha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:58:35.882845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd993a00c-8911-42fb-a683-00d4eb2ba85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1ce90>]}
[0m15:58:35.917037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd993a00c-8911-42fb-a683-00d4eb2ba85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4b460>]}
[0m15:58:35.917925 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:58:35.967499 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m15:58:36.056014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:36.056258 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:36.085810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd993a00c-8911-42fb-a683-00d4eb2ba85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bff450>]}
[0m15:58:36.132452 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:58:36.134478 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:58:36.147086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd993a00c-8911-42fb-a683-00d4eb2ba85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109103980>]}
[0m15:58:36.147360 [info ] [MainThread]: Found 2 models, 7 data tests, 1 seed, 1 snapshot, 433 macros
[0m15:58:36.147532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd993a00c-8911-42fb-a683-00d4eb2ba85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3cc2f0>]}
[0m15:58:36.148552 [info ] [MainThread]: 
[0m15:58:36.148720 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:36.148845 [info ] [MainThread]: 
[0m15:58:36.149105 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:58:36.149541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m15:58:36.183404 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m15:58:36.183661 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m15:58:36.183815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:36.205228 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.021 seconds
[0m15:58:36.206051 [debug] [ThreadPool]: On list_dbt_db: Close
[0m15:58:36.208429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_schema_db)
[0m15:58:36.212076 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:58:36.212293 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m15:58:36.212424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:36.260631 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m15:58:36.260918 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:58:36.261069 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m15:58:36.268366 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:58:36.269261 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m15:58:36.269666 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m15:58:36.270011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now list_dbt_db_snapshots)
[0m15:58:36.271100 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m15:58:36.271234 [debug] [ThreadPool]: On list_dbt_db_snapshots: BEGIN
[0m15:58:36.271347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:36.275861 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:58:36.276038 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m15:58:36.276175 [debug] [ThreadPool]: On list_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:58:36.279888 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m15:58:36.280529 [debug] [ThreadPool]: On list_dbt_db_snapshots: ROLLBACK
[0m15:58:36.280804 [debug] [ThreadPool]: On list_dbt_db_snapshots: Close
[0m15:58:36.283428 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:36.283606 [debug] [MainThread]: On master: BEGIN
[0m15:58:36.283724 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:36.288011 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:58:36.288203 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:36.288520 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:58:36.302215 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m15:58:36.303033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd993a00c-8911-42fb-a683-00d4eb2ba85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a582820>]}
[0m15:58:36.303343 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:36.303815 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:36.303963 [debug] [MainThread]: On master: BEGIN
[0m15:58:36.304497 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:58:36.304621 [debug] [MainThread]: On master: COMMIT
[0m15:58:36.304735 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:36.304842 [debug] [MainThread]: On master: COMMIT
[0m15:58:36.305084 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:58:36.305208 [debug] [MainThread]: On master: Close
[0m15:58:36.306752 [debug] [Thread-1 (]: Began running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:58:36.307008 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.country_codes_snapshot ......................... [RUN]
[0m15:58:36.307221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_snapshots, now snapshot.my_dbt_postgres_project.country_codes_snapshot)
[0m15:58:36.307373 [debug] [Thread-1 (]: Began compiling node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:58:36.311241 [debug] [Thread-1 (]: Began executing node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:58:36.344987 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.345260 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        select country_name, country_code from (
                

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  dbt_db.schema_db.country_codes
  --"dbt_db"."schema_db"."country_codes"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:58:36.345431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:36.355564 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m15:58:36.363104 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.363349 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: BEGIN
[0m15:58:36.363895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m15:58:36.364185 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.364375 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:58:36.387147 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.023 seconds
[0m15:58:36.391233 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.391434 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:58:36.397069 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m15:58:36.422735 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.423061 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

        
  
    

  create temporary table "country_codes_snapshot__dbt_tmp155836418310"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  dbt_db.schema_db.country_codes
  --"dbt_db"."schema_db"."country_codes"

    ),

    snapshotted_data as (

        select *, 
    
        country_name as dbt_unique_key
    

        from "dbt_db"."snapshots"."country_codes_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m15:58:36.433131 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m15:58:36.434653 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.434856 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp155836418310'
        
      order by ordinal_position

  
[0m15:58:36.439832 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m15:58:36.441393 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.441580 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:58:36.445817 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m15:58:36.447358 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.447559 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp155836418310'
        
      order by ordinal_position

  
[0m15:58:36.451576 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m15:58:36.453004 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.453187 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:58:36.458062 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m15:58:36.461064 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.461361 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp155836418310'
        
      order by ordinal_position

  
[0m15:58:36.471146 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.010 seconds
[0m15:58:36.478568 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.478833 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  dbt_db.schema_db.country_codes
  --"dbt_db"."schema_db"."country_codes"

    ),

    snapshotted_data as (

        select *, 
    
        country_name as dbt_unique_key
    

        from "dbt_db"."snapshots"."country_codes_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m15:58:36.479881 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:58:36.481371 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.481527 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:58:36.481942 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:58:36.482175 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.482653 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.483119 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      update "dbt_db"."snapshots"."country_codes_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "country_codes_snapshot__dbt_tmp155836418310" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dbt_db"."snapshots"."country_codes_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "dbt_db"."snapshots"."country_codes_snapshot".dbt_valid_to is null;
      


    insert into "dbt_db"."snapshots"."country_codes_snapshot" ("country_name", "country_code", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."country_name",DBT_INTERNAL_SOURCE."country_code",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "country_codes_snapshot__dbt_tmp155836418310" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:58:36.487452 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m15:58:36.494351 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: COMMIT
[0m15:58:36.494575 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:58:36.494731 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: COMMIT
[0m15:58:36.495896 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:58:36.497573 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: Close
[0m15:58:36.498595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd993a00c-8911-42fb-a683-00d4eb2ba85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a392d50>]}
[0m15:58:36.499017 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.country_codes_snapshot ......................... [[32mINSERT 0 0[0m in 0.19s]
[0m15:58:36.499297 [debug] [Thread-1 (]: Finished running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:58:36.499955 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:36.500100 [debug] [MainThread]: On master: BEGIN
[0m15:58:36.500214 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:36.512791 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m15:58:36.512988 [debug] [MainThread]: On master: COMMIT
[0m15:58:36.513116 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:36.513227 [debug] [MainThread]: On master: COMMIT
[0m15:58:36.513475 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:58:36.513592 [debug] [MainThread]: On master: Close
[0m15:58:36.513789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:36.513904 [debug] [MainThread]: Connection 'snapshot.my_dbt_postgres_project.country_codes_snapshot' was properly closed.
[0m15:58:36.514034 [info ] [MainThread]: 
[0m15:58:36.514228 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m15:58:36.514570 [debug] [MainThread]: Command end result
[0m15:58:36.526702 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:58:36.527954 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:58:36.531217 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m15:58:36.531443 [info ] [MainThread]: 
[0m15:58:36.531730 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:36.531920 [info ] [MainThread]: 
[0m15:58:36.532071 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:58:36.534160 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.84834373, "process_in_blocks": "0", "process_kernel_time": 0.224984, "process_mem_max_rss": "129630208", "process_out_blocks": "0", "process_user_time": 1.096662}
[0m15:58:36.534492 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:58:36.534438 after 0.85 seconds
[0m15:58:36.534689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3b1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7b5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7b5ef0>]}
[0m15:58:36.534875 [debug] [MainThread]: Flushing usage events
[0m15:58:37.257494 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:12.923676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0bb10>]}


============================== 15:59:12.926744 | b2503a5d-b0d9-4a8d-9960-cdd1f912bbeb ==============================
[0m15:59:12.926744 [info ] [MainThread]: Running with dbt=1.9.8
[0m15:59:12.927078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m15:59:13.016621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2503a5d-b0d9-4a8d-9960-cdd1f912bbeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106054e90>]}
[0m15:59:13.049318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2503a5d-b0d9-4a8d-9960-cdd1f912bbeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106983460>]}
[0m15:59:13.050013 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:59:13.094568 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m15:59:13.166529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:59:13.166875 [debug] [MainThread]: Partial parsing: updated file: my_dbt_postgres_project://snapshots/country_code_snapshot.sql
[0m15:59:13.305278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2503a5d-b0d9-4a8d-9960-cdd1f912bbeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107761f50>]}
[0m15:59:13.351882 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:59:13.353734 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:59:13.365233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2503a5d-b0d9-4a8d-9960-cdd1f912bbeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700b890>]}
[0m15:59:13.365507 [info ] [MainThread]: Found 2 models, 7 data tests, 1 seed, 1 snapshot, 433 macros
[0m15:59:13.365671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2503a5d-b0d9-4a8d-9960-cdd1f912bbeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10712fa10>]}
[0m15:59:13.366608 [info ] [MainThread]: 
[0m15:59:13.366791 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:59:13.366915 [info ] [MainThread]: 
[0m15:59:13.367151 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:59:13.367577 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m15:59:13.399223 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m15:59:13.399499 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m15:59:13.399657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:13.424640 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.025 seconds
[0m15:59:13.425554 [debug] [ThreadPool]: On list_dbt_db: Close
[0m15:59:13.428905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_snapshots)
[0m15:59:13.432502 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m15:59:13.432836 [debug] [ThreadPool]: On list_dbt_db_snapshots: BEGIN
[0m15:59:13.433065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:13.438348 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:59:13.438594 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m15:59:13.438739 [debug] [ThreadPool]: On list_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:59:13.451753 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m15:59:13.452642 [debug] [ThreadPool]: On list_dbt_db_snapshots: ROLLBACK
[0m15:59:13.463299 [debug] [ThreadPool]: On list_dbt_db_snapshots: Close
[0m15:59:13.465774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_snapshots, now list_dbt_db_schema_db)
[0m15:59:13.467383 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:59:13.468165 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m15:59:13.468337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:13.476947 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:59:13.477570 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m15:59:13.478157 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m15:59:13.482636 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m15:59:13.483494 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m15:59:13.483804 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m15:59:13.486620 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:13.486868 [debug] [MainThread]: On master: BEGIN
[0m15:59:13.486998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:13.491502 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:59:13.491729 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:13.491918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:59:13.501285 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:59:13.501993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2503a5d-b0d9-4a8d-9960-cdd1f912bbeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c58b0>]}
[0m15:59:13.502249 [debug] [MainThread]: On master: ROLLBACK
[0m15:59:13.502592 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:13.502721 [debug] [MainThread]: On master: BEGIN
[0m15:59:13.503356 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:59:13.503515 [debug] [MainThread]: On master: COMMIT
[0m15:59:13.503639 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:13.503753 [debug] [MainThread]: On master: COMMIT
[0m15:59:13.504038 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:59:13.504172 [debug] [MainThread]: On master: Close
[0m15:59:13.506372 [debug] [Thread-1 (]: Began running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:59:13.506661 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.country_codes_snapshot ......................... [RUN]
[0m15:59:13.506895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now snapshot.my_dbt_postgres_project.country_codes_snapshot)
[0m15:59:13.507059 [debug] [Thread-1 (]: Began compiling node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:59:13.511164 [debug] [Thread-1 (]: Began executing node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:59:13.542724 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.543014 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        select country_name, country_code from (
                

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  --dbt_db.schema_db.country_codes
  "dbt_db"."schema_db"."country_codes"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:59:13.543183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:13.553944 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m15:59:13.561132 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.561455 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: BEGIN
[0m15:59:13.561946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m15:59:13.562165 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.562331 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:59:13.576909 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.014 seconds
[0m15:59:13.581419 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.581674 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:59:13.587760 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m15:59:13.614206 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.614502 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

        
  
    

  create temporary table "country_codes_snapshot__dbt_tmp155913609859"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  --dbt_db.schema_db.country_codes
  "dbt_db"."schema_db"."country_codes"

    ),

    snapshotted_data as (

        select *, 
    
        country_name as dbt_unique_key
    

        from "dbt_db"."snapshots"."country_codes_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m15:59:13.625247 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m15:59:13.626776 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.626982 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp155913609859'
        
      order by ordinal_position

  
[0m15:59:13.634043 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m15:59:13.635628 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.635827 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:59:13.641153 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m15:59:13.642673 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.642876 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp155913609859'
        
      order by ordinal_position

  
[0m15:59:13.649254 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m15:59:13.650869 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.651077 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:59:13.656890 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m15:59:13.660424 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.660626 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp155913609859'
        
      order by ordinal_position

  
[0m15:59:13.666536 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m15:59:13.675148 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.675454 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  --dbt_db.schema_db.country_codes
  "dbt_db"."schema_db"."country_codes"

    ),

    snapshotted_data as (

        select *, 
    
        country_name as dbt_unique_key
    

        from "dbt_db"."snapshots"."country_codes_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m15:59:13.676557 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:59:13.678246 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.678437 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:59:13.678891 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:59:13.679174 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.679695 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.680210 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      update "dbt_db"."snapshots"."country_codes_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "country_codes_snapshot__dbt_tmp155913609859" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dbt_db"."snapshots"."country_codes_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "dbt_db"."snapshots"."country_codes_snapshot".dbt_valid_to is null;
      


    insert into "dbt_db"."snapshots"."country_codes_snapshot" ("country_name", "country_code", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."country_name",DBT_INTERNAL_SOURCE."country_code",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "country_codes_snapshot__dbt_tmp155913609859" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:59:13.681458 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:59:13.688995 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: COMMIT
[0m15:59:13.689199 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m15:59:13.689362 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: COMMIT
[0m15:59:13.690232 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:59:13.692070 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: Close
[0m15:59:13.693200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2503a5d-b0d9-4a8d-9960-cdd1f912bbeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8f110>]}
[0m15:59:13.693619 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.country_codes_snapshot ......................... [[32mINSERT 0 0[0m in 0.19s]
[0m15:59:13.693923 [debug] [Thread-1 (]: Finished running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m15:59:13.694609 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:13.694769 [debug] [MainThread]: On master: BEGIN
[0m15:59:13.694894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:13.717640 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m15:59:13.717906 [debug] [MainThread]: On master: COMMIT
[0m15:59:13.718046 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:13.718170 [debug] [MainThread]: On master: COMMIT
[0m15:59:13.718476 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:59:13.718605 [debug] [MainThread]: On master: Close
[0m15:59:13.718817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:13.718943 [debug] [MainThread]: Connection 'snapshot.my_dbt_postgres_project.country_codes_snapshot' was properly closed.
[0m15:59:13.719078 [info ] [MainThread]: 
[0m15:59:13.719236 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:59:13.719723 [debug] [MainThread]: Command end result
[0m15:59:13.776308 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m15:59:13.777345 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m15:59:13.780642 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m15:59:13.780892 [info ] [MainThread]: 
[0m15:59:13.781181 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:13.781415 [info ] [MainThread]: 
[0m15:59:13.781624 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:59:13.783284 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.9024999, "process_in_blocks": "0", "process_kernel_time": 0.174438, "process_mem_max_rss": "131596288", "process_out_blocks": "0", "process_user_time": 1.21644}
[0m15:59:13.783523 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:59:13.783467 after 0.90 seconds
[0m15:59:13.783702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107892830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f5d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f7d90>]}
[0m15:59:13.783863 [debug] [MainThread]: Flushing usage events
[0m15:59:14.384303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:02:32.791079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108746120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d3b10>]}


============================== 16:02:32.794925 | 598e1b7e-d552-4124-bed9-fc6c99e9b31d ==============================
[0m16:02:32.794925 [info ] [MainThread]: Running with dbt=1.9.8
[0m16:02:32.795227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/maha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:02:32.929434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '598e1b7e-d552-4124-bed9-fc6c99e9b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1ce90>]}
[0m16:02:32.962201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '598e1b7e-d552-4124-bed9-fc6c99e9b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10984b460>]}
[0m16:02:32.962961 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:02:33.012616 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m16:02:33.101040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:02:33.101439 [debug] [MainThread]: Partial parsing: updated file: my_dbt_postgres_project://seeds/country_codes.csv
[0m16:02:33.271638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '598e1b7e-d552-4124-bed9-fc6c99e9b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abced50>]}
[0m16:02:33.313744 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m16:02:33.315870 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m16:02:33.327850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '598e1b7e-d552-4124-bed9-fc6c99e9b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f02e40>]}
[0m16:02:33.328095 [info ] [MainThread]: Found 2 models, 7 data tests, 1 snapshot, 1 seed, 433 macros
[0m16:02:33.328255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '598e1b7e-d552-4124-bed9-fc6c99e9b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2dba10>]}
[0m16:02:33.329163 [info ] [MainThread]: 
[0m16:02:33.329341 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:02:33.329468 [info ] [MainThread]: 
[0m16:02:33.329704 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:33.330107 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m16:02:33.364429 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m16:02:33.364710 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m16:02:33.364890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:33.402388 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.037 seconds
[0m16:02:33.404417 [debug] [ThreadPool]: On list_dbt_db: Close
[0m16:02:33.436583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_snapshots)
[0m16:02:33.439947 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m16:02:33.440182 [debug] [ThreadPool]: On list_dbt_db_snapshots: BEGIN
[0m16:02:33.440313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:33.456238 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m16:02:33.456542 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m16:02:33.456711 [debug] [ThreadPool]: On list_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:02:33.460638 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:02:33.461509 [debug] [ThreadPool]: On list_dbt_db_snapshots: ROLLBACK
[0m16:02:33.461882 [debug] [ThreadPool]: On list_dbt_db_snapshots: Close
[0m16:02:33.462193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_snapshots, now list_dbt_db_schema_db)
[0m16:02:33.463259 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m16:02:33.463420 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m16:02:33.463551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:33.469218 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m16:02:33.469396 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m16:02:33.469537 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m16:02:33.473855 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:02:33.474548 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m16:02:33.474904 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m16:02:33.477630 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:33.477870 [debug] [MainThread]: On master: BEGIN
[0m16:02:33.478026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:33.483898 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:02:33.484127 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:33.484315 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:02:33.496380 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m16:02:33.497077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '598e1b7e-d552-4124-bed9-fc6c99e9b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b795e60>]}
[0m16:02:33.497340 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:33.497630 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:33.497765 [debug] [MainThread]: On master: BEGIN
[0m16:02:33.498120 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:02:33.498253 [debug] [MainThread]: On master: COMMIT
[0m16:02:33.498384 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:33.498702 [debug] [MainThread]: On master: COMMIT
[0m16:02:33.499019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:02:33.499190 [debug] [MainThread]: On master: Close
[0m16:02:33.500934 [debug] [Thread-1 (]: Began running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m16:02:33.501232 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.country_codes_snapshot ......................... [RUN]
[0m16:02:33.501455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now snapshot.my_dbt_postgres_project.country_codes_snapshot)
[0m16:02:33.501621 [debug] [Thread-1 (]: Began compiling node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m16:02:33.505768 [debug] [Thread-1 (]: Began executing node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m16:02:33.537735 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.538037 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        select country_name, country_code from (
                

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  --dbt_db.schema_db.country_codes
  "dbt_db"."schema_db"."country_codes"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m16:02:33.538212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:33.549407 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m16:02:33.556742 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.556932 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: BEGIN
[0m16:02:33.557487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m16:02:33.557727 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.557892 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:02:33.572079 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.014 seconds
[0m16:02:33.576493 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.576722 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:02:33.581709 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m16:02:33.609273 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.609576 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

        
  
    

  create temporary table "country_codes_snapshot__dbt_tmp160233602981"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  --dbt_db.schema_db.country_codes
  "dbt_db"."schema_db"."country_codes"

    ),

    snapshotted_data as (

        select *, 
    
        country_name as dbt_unique_key
    

        from "dbt_db"."snapshots"."country_codes_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:02:33.622161 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.012 seconds
[0m16:02:33.623684 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.623873 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp160233602981'
        
      order by ordinal_position

  
[0m16:02:33.629909 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m16:02:33.631471 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.631675 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:02:33.636204 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m16:02:33.637717 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.637923 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp160233602981'
        
      order by ordinal_position

  
[0m16:02:33.690403 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.016 seconds
[0m16:02:33.692349 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.692556 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:02:33.698166 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m16:02:33.701691 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.701906 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp160233602981'
        
      order by ordinal_position

  
[0m16:02:33.705893 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m16:02:33.714296 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.714576 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  --dbt_db.schema_db.country_codes
  "dbt_db"."schema_db"."country_codes"

    ),

    snapshotted_data as (

        select *, 
    
        country_name as dbt_unique_key
    

        from "dbt_db"."snapshots"."country_codes_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m16:02:33.715628 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m16:02:33.717297 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.717474 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m16:02:33.717926 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:02:33.718173 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.719757 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.719942 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      update "dbt_db"."snapshots"."country_codes_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "country_codes_snapshot__dbt_tmp160233602981" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dbt_db"."snapshots"."country_codes_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "dbt_db"."snapshots"."country_codes_snapshot".dbt_valid_to is null;
      


    insert into "dbt_db"."snapshots"."country_codes_snapshot" ("country_name", "country_code", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."country_name",DBT_INTERNAL_SOURCE."country_code",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "country_codes_snapshot__dbt_tmp160233602981" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:02:33.721239 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m16:02:33.728797 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: COMMIT
[0m16:02:33.729036 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:02:33.729188 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: COMMIT
[0m16:02:33.730521 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:02:33.732671 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: Close
[0m16:02:33.733799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '598e1b7e-d552-4124-bed9-fc6c99e9b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b59f890>]}
[0m16:02:33.734203 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.country_codes_snapshot ......................... [[32mINSERT 0 0[0m in 0.23s]
[0m16:02:33.734524 [debug] [Thread-1 (]: Finished running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m16:02:33.735149 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:33.735308 [debug] [MainThread]: On master: BEGIN
[0m16:02:33.735433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:33.761882 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m16:02:33.762154 [debug] [MainThread]: On master: COMMIT
[0m16:02:33.762305 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:33.762534 [debug] [MainThread]: On master: COMMIT
[0m16:02:33.762884 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:02:33.763171 [debug] [MainThread]: On master: Close
[0m16:02:33.763417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:33.763655 [debug] [MainThread]: Connection 'snapshot.my_dbt_postgres_project.country_codes_snapshot' was properly closed.
[0m16:02:33.763856 [info ] [MainThread]: 
[0m16:02:33.764020 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m16:02:33.764351 [debug] [MainThread]: Command end result
[0m16:02:33.775347 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m16:02:33.776268 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m16:02:33.779476 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m16:02:33.779671 [info ] [MainThread]: 
[0m16:02:33.779859 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:02:33.779994 [info ] [MainThread]: 
[0m16:02:33.780199 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:02:33.781934 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.0489446, "process_in_blocks": "0", "process_kernel_time": 0.221326, "process_mem_max_rss": "131432448", "process_out_blocks": "0", "process_user_time": 1.260347}
[0m16:02:33.782424 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:02:33.782359 after 1.05 seconds
[0m16:02:33.782623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b303330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a49b0>]}
[0m16:02:33.782802 [debug] [MainThread]: Flushing usage events
[0m16:02:34.498022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:03:07.629150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107952120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086dfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086dfb10>]}


============================== 16:03:07.633175 | 8d2a414c-e413-417b-9494-2b71bb59323c ==============================
[0m16:03:07.633175 [info ] [MainThread]: Running with dbt=1.9.8
[0m16:03:07.633593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m16:03:07.737029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d2a414c-e413-417b-9494-2b71bb59323c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c24e90>]}
[0m16:03:07.770367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d2a414c-e413-417b-9494-2b71bb59323c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108557460>]}
[0m16:03:07.771276 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:03:07.847526 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m16:03:07.935569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:07.935837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:07.965899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d2a414c-e413-417b-9494-2b71bb59323c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10860aa50>]}
[0m16:03:08.012865 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m16:03:08.014764 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m16:03:08.026995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d2a414c-e413-417b-9494-2b71bb59323c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdf980>]}
[0m16:03:08.027263 [info ] [MainThread]: Found 2 models, 7 data tests, 1 snapshot, 1 seed, 433 macros
[0m16:03:08.027429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d2a414c-e413-417b-9494-2b71bb59323c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10952c3d0>]}
[0m16:03:08.028351 [info ] [MainThread]: 
[0m16:03:08.028543 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:03:08.028715 [info ] [MainThread]: 
[0m16:03:08.028983 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:03:08.029411 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m16:03:08.060964 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m16:03:08.061310 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m16:03:08.061483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:08.088936 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.027 seconds
[0m16:03:08.089896 [debug] [ThreadPool]: On list_dbt_db: Close
[0m16:03:08.092797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_snapshots)
[0m16:03:08.096142 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m16:03:08.096535 [debug] [ThreadPool]: On list_dbt_db_snapshots: BEGIN
[0m16:03:08.096694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:08.102830 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m16:03:08.103286 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m16:03:08.103533 [debug] [ThreadPool]: On list_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:03:08.115210 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m16:03:08.124145 [debug] [ThreadPool]: On list_dbt_db_snapshots: ROLLBACK
[0m16:03:08.132029 [debug] [ThreadPool]: On list_dbt_db_snapshots: Close
[0m16:03:08.132523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_snapshots, now list_dbt_db_schema_db)
[0m16:03:08.135800 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m16:03:08.136249 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m16:03:08.136444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:08.142244 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m16:03:08.142902 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m16:03:08.143298 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m16:03:08.167365 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.024 seconds
[0m16:03:08.168167 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m16:03:08.168572 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m16:03:08.171487 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:08.171689 [debug] [MainThread]: On master: BEGIN
[0m16:03:08.171826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:08.176535 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:03:08.176734 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:08.176930 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:03:08.196999 [debug] [MainThread]: SQL status: SELECT 0 in 0.020 seconds
[0m16:03:08.197965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d2a414c-e413-417b-9494-2b71bb59323c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e6820>]}
[0m16:03:08.198275 [debug] [MainThread]: On master: ROLLBACK
[0m16:03:08.198797 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:08.198976 [debug] [MainThread]: On master: BEGIN
[0m16:03:08.199493 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:03:08.199647 [debug] [MainThread]: On master: COMMIT
[0m16:03:08.199784 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:08.199909 [debug] [MainThread]: On master: COMMIT
[0m16:03:08.200179 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:03:08.200324 [debug] [MainThread]: On master: Close
[0m16:03:08.201956 [debug] [Thread-1 (]: Began running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m16:03:08.202269 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.country_codes_snapshot ......................... [RUN]
[0m16:03:08.202510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now snapshot.my_dbt_postgres_project.country_codes_snapshot)
[0m16:03:08.202773 [debug] [Thread-1 (]: Began compiling node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m16:03:08.207405 [debug] [Thread-1 (]: Began executing node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m16:03:08.241646 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.241941 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        select country_name, country_code from (
                

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  --dbt_db.schema_db.country_codes
  "dbt_db"."schema_db"."country_codes"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m16:03:08.242111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:08.251716 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m16:03:08.259202 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.259427 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: BEGIN
[0m16:03:08.259933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m16:03:08.260090 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.260239 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:03:08.269660 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.009 seconds
[0m16:03:08.273895 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.274139 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:03:08.277328 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m16:03:08.302779 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.303102 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

        
  
    

  create temporary table "country_codes_snapshot__dbt_tmp160308298735"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  --dbt_db.schema_db.country_codes
  "dbt_db"."schema_db"."country_codes"

    ),

    snapshotted_data as (

        select *, 
    
        country_name as dbt_unique_key
    

        from "dbt_db"."snapshots"."country_codes_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:03:08.308905 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m16:03:08.310346 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.310551 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp160308298735'
        
      order by ordinal_position

  
[0m16:03:08.314675 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m16:03:08.316246 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.316476 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:03:08.319922 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m16:03:08.321323 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.321506 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp160308298735'
        
      order by ordinal_position

  
[0m16:03:08.325992 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m16:03:08.327392 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.327576 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:03:08.331740 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m16:03:08.335126 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.335326 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp160308298735'
        
      order by ordinal_position

  
[0m16:03:08.338776 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m16:03:08.347157 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.347463 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  --dbt_db.schema_db.country_codes
  "dbt_db"."schema_db"."country_codes"

    ),

    snapshotted_data as (

        select *, 
    
        country_name as dbt_unique_key
    

        from "dbt_db"."snapshots"."country_codes_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m16:03:08.348420 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m16:03:08.350478 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.350683 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m16:03:08.351081 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:03:08.351381 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.351912 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.352452 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      update "dbt_db"."snapshots"."country_codes_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "country_codes_snapshot__dbt_tmp160308298735" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dbt_db"."snapshots"."country_codes_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "dbt_db"."snapshots"."country_codes_snapshot".dbt_valid_to is null;
      


    insert into "dbt_db"."snapshots"."country_codes_snapshot" ("country_name", "country_code", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."country_name",DBT_INTERNAL_SOURCE."country_code",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "country_codes_snapshot__dbt_tmp160308298735" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:03:08.353693 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m16:03:08.361347 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: COMMIT
[0m16:03:08.361570 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:03:08.361723 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: COMMIT
[0m16:03:08.362743 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:03:08.364565 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: Close
[0m16:03:08.365741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d2a414c-e413-417b-9494-2b71bb59323c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ead50>]}
[0m16:03:08.366159 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.country_codes_snapshot ......................... [[32mINSERT 0 0[0m in 0.16s]
[0m16:03:08.366453 [debug] [Thread-1 (]: Finished running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m16:03:08.367147 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:08.367287 [debug] [MainThread]: On master: BEGIN
[0m16:03:08.367409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:08.376265 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:03:08.376483 [debug] [MainThread]: On master: COMMIT
[0m16:03:08.376676 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:08.376932 [debug] [MainThread]: On master: COMMIT
[0m16:03:08.377234 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:03:08.377365 [debug] [MainThread]: On master: Close
[0m16:03:08.377543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:08.377660 [debug] [MainThread]: Connection 'snapshot.my_dbt_postgres_project.country_codes_snapshot' was properly closed.
[0m16:03:08.377788 [info ] [MainThread]: 
[0m16:03:08.377932 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m16:03:08.378241 [debug] [MainThread]: Command end result
[0m16:03:08.389872 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m16:03:08.390915 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m16:03:08.394685 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m16:03:08.394879 [info ] [MainThread]: 
[0m16:03:08.395074 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:08.395203 [info ] [MainThread]: 
[0m16:03:08.395406 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:03:08.397161 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.815137, "process_in_blocks": "0", "process_kernel_time": 0.20601, "process_mem_max_rss": "129236992", "process_out_blocks": "0", "process_user_time": 1.108772}
[0m16:03:08.397428 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:03:08.397378 after 0.82 seconds
[0m16:03:08.397625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109526360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109943110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109941630>]}
[0m16:03:08.397809 [debug] [MainThread]: Flushing usage events
[0m16:03:08.994260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:03:32.092182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d3b10>]}


============================== 16:03:32.096424 | 22071e61-f66f-4057-93c3-7f00d2c352b1 ==============================
[0m16:03:32.096424 [info ] [MainThread]: Running with dbt=1.9.8
[0m16:03:32.096790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:32.214557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22071e61-f66f-4057-93c3-7f00d2c352b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105020e90>]}
[0m16:03:32.249262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22071e61-f66f-4057-93c3-7f00d2c352b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644b460>]}
[0m16:03:32.250162 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:03:32.297481 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m16:03:32.387459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:32.387711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:32.418041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22071e61-f66f-4057-93c3-7f00d2c352b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fea50>]}
[0m16:03:32.461927 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m16:03:32.463768 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m16:03:32.476583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22071e61-f66f-4057-93c3-7f00d2c352b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cb7a0>]}
[0m16:03:32.476867 [info ] [MainThread]: Found 2 models, 7 data tests, 1 snapshot, 1 seed, 433 macros
[0m16:03:32.477042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22071e61-f66f-4057-93c3-7f00d2c352b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071dc3d0>]}
[0m16:03:32.478015 [info ] [MainThread]: 
[0m16:03:32.478241 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:03:32.478389 [info ] [MainThread]: 
[0m16:03:32.478640 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:03:32.479084 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m16:03:32.526224 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m16:03:32.526517 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m16:03:32.526679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:32.588289 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.062 seconds
[0m16:03:32.589542 [debug] [ThreadPool]: On list_dbt_db: Close
[0m16:03:32.592223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_schema_db)
[0m16:03:32.597197 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m16:03:32.597479 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m16:03:32.597621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:32.602530 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:03:32.602772 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m16:03:32.602918 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m16:03:32.604588 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m16:03:32.605309 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m16:03:32.605565 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m16:03:32.605831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now list_dbt_db_snapshots)
[0m16:03:32.606937 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m16:03:32.607214 [debug] [ThreadPool]: On list_dbt_db_snapshots: BEGIN
[0m16:03:32.607373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:32.610624 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:03:32.610828 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m16:03:32.610987 [debug] [ThreadPool]: On list_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:03:32.612743 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m16:03:32.613417 [debug] [ThreadPool]: On list_dbt_db_snapshots: ROLLBACK
[0m16:03:32.613696 [debug] [ThreadPool]: On list_dbt_db_snapshots: Close
[0m16:03:32.616503 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:32.616722 [debug] [MainThread]: On master: BEGIN
[0m16:03:32.616856 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:32.621857 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:03:32.622057 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:32.622239 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:03:32.629848 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m16:03:32.630573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22071e61-f66f-4057-93c3-7f00d2c352b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107396340>]}
[0m16:03:32.630829 [debug] [MainThread]: On master: ROLLBACK
[0m16:03:32.631130 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:32.631256 [debug] [MainThread]: On master: BEGIN
[0m16:03:32.631620 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:03:32.631894 [debug] [MainThread]: On master: COMMIT
[0m16:03:32.632102 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:32.632238 [debug] [MainThread]: On master: COMMIT
[0m16:03:32.632480 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:03:32.632608 [debug] [MainThread]: On master: Close
[0m16:03:32.634221 [debug] [Thread-1 (]: Began running node seed.my_dbt_postgres_project.country_codes
[0m16:03:32.634493 [info ] [Thread-1 (]: 1 of 1 START seed file schema_db.country_codes ................................. [RUN]
[0m16:03:32.634705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_snapshots, now seed.my_dbt_postgres_project.country_codes)
[0m16:03:32.634874 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_postgres_project.country_codes
[0m16:03:32.635032 [debug] [Thread-1 (]: Began executing node seed.my_dbt_postgres_project.country_codes
[0m16:03:32.652965 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.country_codes"
[0m16:03:32.653221 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: BEGIN
[0m16:03:32.653371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:32.664236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:03:32.664580 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.country_codes"
[0m16:03:32.664750 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "seed.my_dbt_postgres_project.country_codes"} */
truncate table "dbt_db"."schema_db"."country_codes"
[0m16:03:32.667963 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m16:03:32.681126 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.country_codes"
[0m16:03:32.681365 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: 
          insert into "dbt_db"."schema_db"."country_codes" ("country_name", "country_code") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m16:03:32.682992 [debug] [Thread-1 (]: SQL status: INSERT 0 41 in 0.001 seconds
[0m16:03:32.685979 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_dbt_postgres_project.country_codes"
[0m16:03:32.694029 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: COMMIT
[0m16:03:32.694229 [debug] [Thread-1 (]: Using postgres connection "seed.my_dbt_postgres_project.country_codes"
[0m16:03:32.694380 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: COMMIT
[0m16:03:32.700307 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m16:03:32.701416 [debug] [Thread-1 (]: On seed.my_dbt_postgres_project.country_codes: Close
[0m16:03:32.702584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22071e61-f66f-4057-93c3-7f00d2c352b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719da90>]}
[0m16:03:32.702907 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file schema_db.country_codes ............................. [[32mINSERT 41[0m in 0.07s]
[0m16:03:32.703201 [debug] [Thread-1 (]: Finished running node seed.my_dbt_postgres_project.country_codes
[0m16:03:32.703858 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:32.704011 [debug] [MainThread]: On master: BEGIN
[0m16:03:32.704129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:32.709677 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:03:32.709842 [debug] [MainThread]: On master: COMMIT
[0m16:03:32.709968 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:32.710082 [debug] [MainThread]: On master: COMMIT
[0m16:03:32.710413 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:03:32.710618 [debug] [MainThread]: On master: Close
[0m16:03:32.710852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:32.711095 [debug] [MainThread]: Connection 'seed.my_dbt_postgres_project.country_codes' was properly closed.
[0m16:03:32.711307 [info ] [MainThread]: 
[0m16:03:32.711476 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m16:03:32.711793 [debug] [MainThread]: Command end result
[0m16:03:32.723379 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m16:03:32.724492 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m16:03:32.727596 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m16:03:32.727849 [info ] [MainThread]: 
[0m16:03:32.728338 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:32.728747 [info ] [MainThread]: 
[0m16:03:32.729129 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:03:32.731263 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.6855544, "process_in_blocks": "0", "process_kernel_time": 0.212669, "process_mem_max_rss": "127516672", "process_out_blocks": "0", "process_user_time": 1.033813}
[0m16:03:32.731747 [debug] [MainThread]: Command `dbt seed` succeeded at 16:03:32.731628 after 0.69 seconds
[0m16:03:32.731998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107763570>]}
[0m16:03:32.732193 [debug] [MainThread]: Flushing usage events
[0m16:03:33.328446 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:17.542122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e8e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad3b10>]}


============================== 16:04:17.546088 | 11b73b15-75f6-4ed8-94dd-38377469de69 ==============================
[0m16:04:17.546088 [info ] [MainThread]: Running with dbt=1.9.8
[0m16:04:17.546424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'profiles_dir': '/Users/maha/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m16:04:17.662021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11b73b15-75f6-4ed8-94dd-38377469de69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10951ce90>]}
[0m16:04:17.695048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11b73b15-75f6-4ed8-94dd-38377469de69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a84b460>]}
[0m16:04:17.695892 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:04:17.769738 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m16:04:17.861288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:04:17.861538 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:04:17.890976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11b73b15-75f6-4ed8-94dd-38377469de69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8fea50>]}
[0m16:04:17.936672 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m16:04:17.938465 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m16:04:17.950305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11b73b15-75f6-4ed8-94dd-38377469de69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af03980>]}
[0m16:04:17.950563 [info ] [MainThread]: Found 2 models, 7 data tests, 1 snapshot, 1 seed, 433 macros
[0m16:04:17.950725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11b73b15-75f6-4ed8-94dd-38377469de69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1cc3d0>]}
[0m16:04:17.951647 [info ] [MainThread]: 
[0m16:04:17.951813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:04:17.951938 [info ] [MainThread]: 
[0m16:04:17.952183 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:04:17.952585 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m16:04:17.985255 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m16:04:17.985531 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m16:04:17.985680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:18.024897 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.039 seconds
[0m16:04:18.025994 [debug] [ThreadPool]: On list_dbt_db: Close
[0m16:04:18.028656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_schema_db)
[0m16:04:18.033761 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m16:04:18.034039 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m16:04:18.034176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:18.069348 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m16:04:18.069629 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m16:04:18.069783 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m16:04:18.073555 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m16:04:18.074470 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m16:04:18.074889 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m16:04:18.075237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now list_dbt_db_snapshots)
[0m16:04:18.076154 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m16:04:18.076304 [debug] [ThreadPool]: On list_dbt_db_snapshots: BEGIN
[0m16:04:18.076425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:18.081455 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:04:18.081697 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m16:04:18.081850 [debug] [ThreadPool]: On list_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:04:18.085357 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m16:04:18.086088 [debug] [ThreadPool]: On list_dbt_db_snapshots: ROLLBACK
[0m16:04:18.086370 [debug] [ThreadPool]: On list_dbt_db_snapshots: Close
[0m16:04:18.088982 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:18.089167 [debug] [MainThread]: On master: BEGIN
[0m16:04:18.089302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:04:18.093397 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:04:18.093608 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:18.093804 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:04:18.105579 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m16:04:18.106216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11b73b15-75f6-4ed8-94dd-38377469de69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c37e4e0>]}
[0m16:04:18.106446 [debug] [MainThread]: On master: ROLLBACK
[0m16:04:18.106825 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:18.107027 [debug] [MainThread]: On master: BEGIN
[0m16:04:18.107520 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:04:18.107692 [debug] [MainThread]: On master: COMMIT
[0m16:04:18.107837 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:18.107963 [debug] [MainThread]: On master: COMMIT
[0m16:04:18.108231 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:04:18.108362 [debug] [MainThread]: On master: Close
[0m16:04:18.110000 [debug] [Thread-1 (]: Began running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m16:04:18.110292 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.country_codes_snapshot ......................... [RUN]
[0m16:04:18.110524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_snapshots, now snapshot.my_dbt_postgres_project.country_codes_snapshot)
[0m16:04:18.110694 [debug] [Thread-1 (]: Began compiling node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m16:04:18.114867 [debug] [Thread-1 (]: Began executing node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m16:04:18.149155 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.149447 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        select country_name, country_code from (
                

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  --dbt_db.schema_db.country_codes
  "dbt_db"."schema_db"."country_codes"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m16:04:18.149614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:18.156754 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m16:04:18.164177 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.164419 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: BEGIN
[0m16:04:18.165085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m16:04:18.165306 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.165471 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:04:18.180153 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.014 seconds
[0m16:04:18.184410 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.184647 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:04:18.189182 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m16:04:18.214665 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.214962 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

        
  
    

  create temporary table "country_codes_snapshot__dbt_tmp160418210528"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  --dbt_db.schema_db.country_codes
  "dbt_db"."schema_db"."country_codes"

    ),

    snapshotted_data as (

        select *, 
    
        country_name as dbt_unique_key
    

        from "dbt_db"."snapshots"."country_codes_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:04:18.227622 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.012 seconds
[0m16:04:18.229192 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.229404 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp160418210528'
        
      order by ordinal_position

  
[0m16:04:18.235273 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m16:04:18.236803 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.237000 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:04:18.241312 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m16:04:18.242789 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.242981 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp160418210528'
        
      order by ordinal_position

  
[0m16:04:18.248359 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m16:04:18.249995 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.250199 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db".INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:04:18.254504 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m16:04:18.258436 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.258679 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'country_codes_snapshot__dbt_tmp160418210528'
        
      order by ordinal_position

  
[0m16:04:18.264711 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m16:04:18.273307 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.273620 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        

SELECT *
  --country_name,
  --country_code,
  --updated_at
FROM
  --dbt_db.schema_db.country_codes
  "dbt_db"."schema_db"."country_codes"

    ),

    snapshotted_data as (

        select *, 
    
        country_name as dbt_unique_key
    

        from "dbt_db"."snapshots"."country_codes_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(country_name as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        country_name as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."country_name" != source_data."country_name"
        or
        (
            ((snapshotted_data."country_name" is null) and not (source_data."country_name" is null))
            or
            ((not snapshotted_data."country_name" is null) and (source_data."country_name" is null))
        ) or snapshotted_data."country_code" != source_data."country_code"
        or
        (
            ((snapshotted_data."country_code" is null) and not (source_data."country_code" is null))
            or
            ((not snapshotted_data."country_code" is null) and (source_data."country_code" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m16:04:18.274705 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m16:04:18.276718 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.276964 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m16:04:18.277461 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:04:18.277774 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.281671 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.282247 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "snapshot.my_dbt_postgres_project.country_codes_snapshot"} */

      update "dbt_db"."snapshots"."country_codes_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "country_codes_snapshot__dbt_tmp160418210528" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dbt_db"."snapshots"."country_codes_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "dbt_db"."snapshots"."country_codes_snapshot".dbt_valid_to is null;
      


    insert into "dbt_db"."snapshots"."country_codes_snapshot" ("country_name", "country_code", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."country_name",DBT_INTERNAL_SOURCE."country_code",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "country_codes_snapshot__dbt_tmp160418210528" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:04:18.283865 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m16:04:18.291640 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: COMMIT
[0m16:04:18.291847 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_dbt_postgres_project.country_codes_snapshot"
[0m16:04:18.292003 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: COMMIT
[0m16:04:18.293104 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:04:18.295108 [debug] [Thread-1 (]: On snapshot.my_dbt_postgres_project.country_codes_snapshot: Close
[0m16:04:18.296228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11b73b15-75f6-4ed8-94dd-38377469de69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c186d50>]}
[0m16:04:18.296670 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.country_codes_snapshot ......................... [[32mINSERT 0 1[0m in 0.18s]
[0m16:04:18.296959 [debug] [Thread-1 (]: Finished running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m16:04:18.297608 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:18.297782 [debug] [MainThread]: On master: BEGIN
[0m16:04:18.297918 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:04:18.308124 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:04:18.308288 [debug] [MainThread]: On master: COMMIT
[0m16:04:18.308412 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:18.308524 [debug] [MainThread]: On master: COMMIT
[0m16:04:18.308800 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:04:18.309056 [debug] [MainThread]: On master: Close
[0m16:04:18.309305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:18.309437 [debug] [MainThread]: Connection 'snapshot.my_dbt_postgres_project.country_codes_snapshot' was properly closed.
[0m16:04:18.309573 [info ] [MainThread]: 
[0m16:04:18.309843 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m16:04:18.310184 [debug] [MainThread]: Command end result
[0m16:04:18.322537 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m16:04:18.324106 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m16:04:18.327455 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m16:04:18.327634 [info ] [MainThread]: 
[0m16:04:18.327888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:18.328081 [info ] [MainThread]: 
[0m16:04:18.328247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:04:18.330049 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.8400894, "process_in_blocks": "0", "process_kernel_time": 0.214286, "process_mem_max_rss": "129105920", "process_out_blocks": "0", "process_user_time": 1.09228}
[0m16:04:18.330366 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:04:18.330313 after 0.84 seconds
[0m16:04:18.330562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1c2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5b7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5b5630>]}
[0m16:04:18.330745 [debug] [MainThread]: Flushing usage events
[0m16:04:19.041130 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:35.193964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108162120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eefd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eefb10>]}


============================== 17:30:35.198002 | 2c9d83e5-ea76-464b-8c95-144afd466f58 ==============================
[0m17:30:35.198002 [info ] [MainThread]: Running with dbt=1.9.8
[0m17:30:35.198446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:30:35.454605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c9d83e5-ea76-464b-8c95-144afd466f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108438e90>]}
[0m17:30:35.488434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c9d83e5-ea76-464b-8c95-144afd466f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d67460>]}
[0m17:30:35.489312 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:30:35.537939 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m17:30:35.627579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:30:35.627970 [debug] [MainThread]: Partial parsing: updated file: my_dbt_postgres_project://snapshots/country_code_snapshot.sql
[0m17:30:35.758699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c9d83e5-ea76-464b-8c95-144afd466f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b46050>]}
[0m17:30:35.806806 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m17:30:35.808661 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m17:30:35.821798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c9d83e5-ea76-464b-8c95-144afd466f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ef890>]}
[0m17:30:35.822098 [info ] [MainThread]: Found 2 models, 7 data tests, 1 seed, 1 snapshot, 433 macros
[0m17:30:35.822267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c9d83e5-ea76-464b-8c95-144afd466f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bfdc50>]}
[0m17:30:35.823242 [info ] [MainThread]: 
[0m17:30:35.823425 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:30:35.823550 [info ] [MainThread]: 
[0m17:30:35.823906 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:30:35.825757 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m17:30:35.861170 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m17:30:35.861478 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m17:30:35.861669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:35.983281 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.122 seconds
[0m17:30:35.984505 [debug] [ThreadPool]: On list_dbt_db: Close
[0m17:30:35.985501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_snapshots)
[0m17:30:35.988823 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m17:30:35.989025 [debug] [ThreadPool]: On list_dbt_db_snapshots: BEGIN
[0m17:30:35.989167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:35.994469 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m17:30:35.994660 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m17:30:35.994806 [debug] [ThreadPool]: On list_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:30:36.000557 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m17:30:36.001323 [debug] [ThreadPool]: On list_dbt_db_snapshots: ROLLBACK
[0m17:30:36.001658 [debug] [ThreadPool]: On list_dbt_db_snapshots: Close
[0m17:30:36.001917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_snapshots, now list_dbt_db_schema_db)
[0m17:30:36.002972 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m17:30:36.003144 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m17:30:36.003278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:36.008777 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m17:30:36.008942 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m17:30:36.009096 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m17:30:36.012434 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m17:30:36.013091 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m17:30:36.013394 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m17:30:36.016365 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:36.016572 [debug] [MainThread]: On master: BEGIN
[0m17:30:36.016719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:36.021885 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m17:30:36.022051 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:36.022260 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:30:36.034873 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m17:30:36.035528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c9d83e5-ea76-464b-8c95-144afd466f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8e4940>]}
[0m17:30:36.035785 [debug] [MainThread]: On master: ROLLBACK
[0m17:30:36.036078 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:36.036218 [debug] [MainThread]: On master: BEGIN
[0m17:30:36.036640 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:30:36.036781 [debug] [MainThread]: On master: COMMIT
[0m17:30:36.036910 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:36.037037 [debug] [MainThread]: On master: COMMIT
[0m17:30:36.037279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:30:36.037414 [debug] [MainThread]: On master: Close
[0m17:30:36.038973 [debug] [Thread-1 (]: Began running node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:30:36.039253 [info ] [Thread-1 (]: 1 of 2 START sql table model schema_db.my_first_dbt_model ...................... [RUN]
[0m17:30:36.039483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now model.my_dbt_postgres_project.my_first_dbt_model)
[0m17:30:36.039658 [debug] [Thread-1 (]: Began compiling node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:30:36.043721 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_postgres_project.my_first_dbt_model"
[0m17:30:36.044307 [debug] [Thread-1 (]: Began executing node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:30:36.065952 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_postgres_project.my_first_dbt_model"
[0m17:30:36.066680 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_postgres_project.my_first_dbt_model"
[0m17:30:36.066914 [debug] [Thread-1 (]: On model.my_dbt_postgres_project.my_first_dbt_model: BEGIN
[0m17:30:36.067067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:36.075985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:30:36.076254 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_postgres_project.my_first_dbt_model"
[0m17:30:36.076422 [debug] [Thread-1 (]: On model.my_dbt_postgres_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "model.my_dbt_postgres_project.my_first_dbt_model"} */

  
    

  create  table "dbt_db"."schema_db"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:30:36.081855 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m17:30:36.087802 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_postgres_project.my_first_dbt_model"
[0m17:30:36.088026 [debug] [Thread-1 (]: On model.my_dbt_postgres_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "model.my_dbt_postgres_project.my_first_dbt_model"} */
alter table "dbt_db"."schema_db"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:30:36.090429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:30:36.097882 [debug] [Thread-1 (]: On model.my_dbt_postgres_project.my_first_dbt_model: COMMIT
[0m17:30:36.098139 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_postgres_project.my_first_dbt_model"
[0m17:30:36.098301 [debug] [Thread-1 (]: On model.my_dbt_postgres_project.my_first_dbt_model: COMMIT
[0m17:30:36.099260 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:30:36.102447 [debug] [Thread-1 (]: Applying DROP to: "dbt_db"."schema_db"."my_first_dbt_model__dbt_backup"
[0m17:30:36.104731 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_postgres_project.my_first_dbt_model"
[0m17:30:36.104919 [debug] [Thread-1 (]: On model.my_dbt_postgres_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "model.my_dbt_postgres_project.my_first_dbt_model"} */
drop table if exists "dbt_db"."schema_db"."my_first_dbt_model__dbt_backup" cascade
[0m17:30:36.105529 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m17:30:36.106843 [debug] [Thread-1 (]: On model.my_dbt_postgres_project.my_first_dbt_model: Close
[0m17:30:36.108152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c9d83e5-ea76-464b-8c95-144afd466f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e16690>]}
[0m17:30:36.108517 [info ] [Thread-1 (]: 1 of 2 OK created sql table model schema_db.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.07s]
[0m17:30:36.108790 [debug] [Thread-1 (]: Finished running node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:30:36.109165 [debug] [Thread-1 (]: Began running node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:30:36.109447 [info ] [Thread-1 (]: 2 of 2 START sql view model schema_db.my_second_dbt_model ...................... [RUN]
[0m17:30:36.109702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_postgres_project.my_first_dbt_model, now model.my_dbt_postgres_project.my_second_dbt_model)
[0m17:30:36.109869 [debug] [Thread-1 (]: Began compiling node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:30:36.111190 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_postgres_project.my_second_dbt_model"
[0m17:30:36.111640 [debug] [Thread-1 (]: Began executing node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:30:36.120780 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_postgres_project.my_second_dbt_model"
[0m17:30:36.121322 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_postgres_project.my_second_dbt_model"
[0m17:30:36.121492 [debug] [Thread-1 (]: On model.my_dbt_postgres_project.my_second_dbt_model: BEGIN
[0m17:30:36.121642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:36.139110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:30:36.139390 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_postgres_project.my_second_dbt_model"
[0m17:30:36.139598 [debug] [Thread-1 (]: On model.my_dbt_postgres_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "model.my_dbt_postgres_project.my_second_dbt_model"} */

  create view "dbt_db"."schema_db"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_db"."schema_db"."my_first_dbt_model"
where id = 1
  );
[0m17:30:36.152479 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:30:36.154029 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_postgres_project.my_second_dbt_model"
[0m17:30:36.154199 [debug] [Thread-1 (]: On model.my_dbt_postgres_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "model.my_dbt_postgres_project.my_second_dbt_model"} */
alter table "dbt_db"."schema_db"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:30:36.154899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:30:36.155535 [debug] [Thread-1 (]: On model.my_dbt_postgres_project.my_second_dbt_model: COMMIT
[0m17:30:36.155684 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_postgres_project.my_second_dbt_model"
[0m17:30:36.155823 [debug] [Thread-1 (]: On model.my_dbt_postgres_project.my_second_dbt_model: COMMIT
[0m17:30:36.156945 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:30:36.158537 [debug] [Thread-1 (]: Applying DROP to: "dbt_db"."schema_db"."my_second_dbt_model__dbt_backup"
[0m17:30:36.160075 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_postgres_project.my_second_dbt_model"
[0m17:30:36.160254 [debug] [Thread-1 (]: On model.my_dbt_postgres_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "node_id": "model.my_dbt_postgres_project.my_second_dbt_model"} */
drop view if exists "dbt_db"."schema_db"."my_second_dbt_model__dbt_backup" cascade
[0m17:30:36.161406 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:30:36.162092 [debug] [Thread-1 (]: On model.my_dbt_postgres_project.my_second_dbt_model: Close
[0m17:30:36.162374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c9d83e5-ea76-464b-8c95-144afd466f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c7e830>]}
[0m17:30:36.162657 [info ] [Thread-1 (]: 2 of 2 OK created sql view model schema_db.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.05s]
[0m17:30:36.162908 [debug] [Thread-1 (]: Finished running node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:30:36.163538 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:36.163728 [debug] [MainThread]: On master: BEGIN
[0m17:30:36.163851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:36.169464 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:30:36.169697 [debug] [MainThread]: On master: COMMIT
[0m17:30:36.169858 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:36.169996 [debug] [MainThread]: On master: COMMIT
[0m17:30:36.170264 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:30:36.170420 [debug] [MainThread]: On master: Close
[0m17:30:36.170604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:36.170719 [debug] [MainThread]: Connection 'model.my_dbt_postgres_project.my_second_dbt_model' was properly closed.
[0m17:30:36.170850 [info ] [MainThread]: 
[0m17:30:36.170995 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:30:36.171353 [debug] [MainThread]: Command end result
[0m17:30:36.184588 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m17:30:36.185692 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m17:30:36.188806 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m17:30:36.189003 [info ] [MainThread]: 
[0m17:30:36.189206 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:36.189411 [info ] [MainThread]: 
[0m17:30:36.189567 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:30:36.202705 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.062261, "process_in_blocks": "0", "process_kernel_time": 0.247686, "process_mem_max_rss": "130498560", "process_out_blocks": "0", "process_user_time": 1.177389}
[0m17:30:36.203062 [debug] [MainThread]: Command `dbt run` succeeded at 17:30:36.203005 after 1.06 seconds
[0m17:30:36.203268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e20440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ba39d0>]}
[0m17:30:36.203455 [debug] [MainThread]: Flushing usage events
[0m17:30:36.937686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:25.709927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c46120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bd3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bd3b10>]}


============================== 17:38:25.713936 | 9222e70b-dcb0-4553-9007-19cc07351cdf ==============================
[0m17:38:25.713936 [info ] [MainThread]: Running with dbt=1.9.8
[0m17:38:25.714274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:38:25.819588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9222e70b-dcb0-4553-9007-19cc07351cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105fce90>]}
[0m17:38:25.852982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9222e70b-dcb0-4553-9007-19cc07351cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a4b460>]}
[0m17:38:25.853779 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:38:25.901197 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m17:38:25.990774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:25.991047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:26.022274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9222e70b-dcb0-4553-9007-19cc07351cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aff450>]}
[0m17:38:26.035974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9222e70b-dcb0-4553-9007-19cc07351cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c38b90>]}
[0m17:38:26.036251 [info ] [MainThread]: Found 2 models, 7 data tests, 1 seed, 1 snapshot, 433 macros
[0m17:38:26.036427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9222e70b-dcb0-4553-9007-19cc07351cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a2faf0>]}
[0m17:38:26.037475 [info ] [MainThread]: 
[0m17:38:26.037662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:26.037789 [info ] [MainThread]: 
[0m17:38:26.038021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:38:26.040102 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_snapshots'
[0m17:38:26.083189 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m17:38:26.083451 [debug] [ThreadPool]: On list_dbt_db_snapshots: BEGIN
[0m17:38:26.083594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:26.128042 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m17:38:26.128632 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m17:38:26.130605 [debug] [ThreadPool]: On list_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:38:26.149446 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.018 seconds
[0m17:38:26.150506 [debug] [ThreadPool]: On list_dbt_db_snapshots: ROLLBACK
[0m17:38:26.151391 [debug] [ThreadPool]: On list_dbt_db_snapshots: Close
[0m17:38:26.152578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_snapshots, now list_dbt_db_schema_db)
[0m17:38:26.154723 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m17:38:26.154972 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m17:38:26.155111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:26.163852 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m17:38:26.164124 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m17:38:26.164280 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m17:38:26.168295 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m17:38:26.169125 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m17:38:26.169550 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m17:38:26.172208 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:26.172431 [debug] [MainThread]: On master: BEGIN
[0m17:38:26.172560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:26.177386 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m17:38:26.177597 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:26.177786 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:38:26.193627 [debug] [MainThread]: SQL status: SELECT 1 in 0.016 seconds
[0m17:38:26.194554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9222e70b-dcb0-4553-9007-19cc07351cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11300c530>]}
[0m17:38:26.194784 [debug] [MainThread]: On master: ROLLBACK
[0m17:38:26.195087 [debug] [MainThread]: On master: Close
[0m17:38:26.196699 [debug] [Thread-1 (]: Began running node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:38:26.196924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now model.my_dbt_postgres_project.my_first_dbt_model)
[0m17:38:26.197101 [debug] [Thread-1 (]: Began compiling node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:38:26.201667 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_postgres_project.my_first_dbt_model"
[0m17:38:26.202494 [debug] [Thread-1 (]: Began executing node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:38:26.202829 [debug] [Thread-1 (]: Finished running node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:38:26.203014 [debug] [Thread-1 (]: Began running node seed.my_dbt_postgres_project.country_codes
[0m17:38:26.203301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_postgres_project.my_first_dbt_model, now seed.my_dbt_postgres_project.country_codes)
[0m17:38:26.203561 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_postgres_project.country_codes
[0m17:38:26.204461 [debug] [Thread-1 (]: Began executing node seed.my_dbt_postgres_project.country_codes
[0m17:38:26.204787 [debug] [Thread-1 (]: Finished running node seed.my_dbt_postgres_project.country_codes
[0m17:38:26.204964 [debug] [Thread-1 (]: Began running node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:38:26.205156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_postgres_project.country_codes, now model.my_dbt_postgres_project.my_second_dbt_model)
[0m17:38:26.205346 [debug] [Thread-1 (]: Began compiling node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:38:26.206641 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_postgres_project.my_second_dbt_model"
[0m17:38:26.207007 [debug] [Thread-1 (]: Began executing node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:38:26.207287 [debug] [Thread-1 (]: Finished running node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:38:26.207451 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:38:26.207712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_postgres_project.my_second_dbt_model, now test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710)
[0m17:38:26.207974 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:38:26.214082 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:38:26.214943 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:38:26.215301 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:38:26.215476 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m17:38:26.215655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321)
[0m17:38:26.215799 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m17:38:26.218800 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321"
[0m17:38:26.219679 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m17:38:26.220015 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m17:38:26.220205 [debug] [Thread-1 (]: Began running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m17:38:26.220393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321, now snapshot.my_dbt_postgres_project.country_codes_snapshot)
[0m17:38:26.220573 [debug] [Thread-1 (]: Began compiling node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m17:38:26.222324 [debug] [Thread-1 (]: Began executing node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m17:38:26.222633 [debug] [Thread-1 (]: Finished running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m17:38:26.222815 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m17:38:26.222989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.my_dbt_postgres_project.country_codes_snapshot, now test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea)
[0m17:38:26.223135 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m17:38:26.225014 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea"
[0m17:38:26.225759 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m17:38:26.226156 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m17:38:26.226329 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m17:38:26.226512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea, now test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b)
[0m17:38:26.226665 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m17:38:26.228553 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b"
[0m17:38:26.229268 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m17:38:26.229549 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m17:38:26.229706 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m17:38:26.229875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b, now test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f)
[0m17:38:26.230023 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m17:38:26.234236 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f"
[0m17:38:26.234690 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m17:38:26.235017 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m17:38:26.235212 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:38:26.235405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f, now test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778)
[0m17:38:26.235561 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:38:26.237411 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778"
[0m17:38:26.237814 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:38:26.238119 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:38:26.238292 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:38:26.238482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778, now test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m17:38:26.238649 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:38:26.240608 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:38:26.240983 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:38:26.241262 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:38:26.241750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:26.241890 [debug] [MainThread]: Connection 'test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m17:38:26.242673 [debug] [MainThread]: Command end result
[0m17:38:26.288428 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m17:38:26.290808 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m17:38:26.295349 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m17:38:26.296931 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:38:26.297078 [info ] [MainThread]: Building catalog
[0m17:38:26.301099 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db.information_schema'
[0m17:38:26.304638 [debug] [ThreadPool]: Using postgres connection "dbt_db.information_schema"
[0m17:38:26.304830 [debug] [ThreadPool]: On dbt_db.information_schema: BEGIN
[0m17:38:26.304955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:26.324012 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m17:38:26.324480 [debug] [ThreadPool]: Using postgres connection "dbt_db.information_schema"
[0m17:38:26.324797 [debug] [ThreadPool]: On dbt_db.information_schema: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "dbt_db.information_schema"} */

    
    

    select
        'dbt_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('schema_db') and
           upper(tbl.relname) = upper('country_codes')) or (upper(sch.nspname) = upper('schema_db') and
           upper(tbl.relname) = upper('my_first_dbt_model')) or (upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('country_codes_snapshot')) or (upper(sch.nspname) = upper('schema_db') and
           upper(tbl.relname) = upper('my_second_dbt_model')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:38:26.336904 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.012 seconds
[0m17:38:26.338756 [debug] [ThreadPool]: On dbt_db.information_schema: ROLLBACK
[0m17:38:26.339263 [debug] [ThreadPool]: On dbt_db.information_schema: Close
[0m17:38:26.344723 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/maha/my_dbt_postgres_project/target/catalog.json
[0m17:38:26.355751 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m17:38:26.356904 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m17:38:26.357086 [info ] [MainThread]: Catalog written to /Users/maha/my_dbt_postgres_project/target/catalog.json
[0m17:38:26.358747 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.6979289, "process_in_blocks": "0", "process_kernel_time": 0.214528, "process_mem_max_rss": "128499712", "process_out_blocks": "0", "process_user_time": 1.034272}
[0m17:38:26.359075 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:38:26.359023 after 0.70 seconds
[0m17:38:26.359258 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:38:26.359382 [debug] [MainThread]: Connection 'dbt_db.information_schema' was properly closed.
[0m17:38:26.359535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bb4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113036c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113036db0>]}
[0m17:38:26.359722 [debug] [MainThread]: Flushing usage events
[0m17:38:27.143507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:10.477360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104486120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105213d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105213b10>]}


============================== 17:40:10.481180 | 109ac80c-3dad-4dfe-93d9-ec3fa49301e3 ==============================
[0m17:40:10.481180 [info ] [MainThread]: Running with dbt=1.9.8
[0m17:40:10.481737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maha/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:10.620776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '109ac80c-3dad-4dfe-93d9-ec3fa49301e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475ce90>]}
[0m17:40:10.653668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '109ac80c-3dad-4dfe-93d9-ec3fa49301e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508b460>]}
[0m17:40:10.654634 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:40:10.703072 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m17:40:10.791612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:40:10.791837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:40:10.822502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '109ac80c-3dad-4dfe-93d9-ec3fa49301e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513f450>]}
[0m17:40:10.835510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '109ac80c-3dad-4dfe-93d9-ec3fa49301e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd0b90>]}
[0m17:40:10.835788 [info ] [MainThread]: Found 2 models, 7 data tests, 1 seed, 1 snapshot, 433 macros
[0m17:40:10.835958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '109ac80c-3dad-4dfe-93d9-ec3fa49301e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f43af0>]}
[0m17:40:10.837048 [info ] [MainThread]: 
[0m17:40:10.837240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:10.837377 [info ] [MainThread]: 
[0m17:40:10.837630 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:40:10.839891 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_schema_db'
[0m17:40:10.875930 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m17:40:10.876195 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m17:40:10.876349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:10.896574 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m17:40:10.896853 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m17:40:10.897134 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m17:40:10.912392 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.015 seconds
[0m17:40:10.913341 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m17:40:10.913901 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m17:40:10.914506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now list_dbt_db_snapshots)
[0m17:40:10.916068 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m17:40:10.916292 [debug] [ThreadPool]: On list_dbt_db_snapshots: BEGIN
[0m17:40:10.916422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:10.954454 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m17:40:10.954764 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m17:40:10.954917 [debug] [ThreadPool]: On list_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:40:10.980408 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.025 seconds
[0m17:40:10.981224 [debug] [ThreadPool]: On list_dbt_db_snapshots: ROLLBACK
[0m17:40:10.981687 [debug] [ThreadPool]: On list_dbt_db_snapshots: Close
[0m17:40:10.984493 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:10.984691 [debug] [MainThread]: On master: BEGIN
[0m17:40:10.984825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:10.990291 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m17:40:10.990606 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:10.990810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:40:11.003472 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m17:40:11.004458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '109ac80c-3dad-4dfe-93d9-ec3fa49301e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a4530>]}
[0m17:40:11.004694 [debug] [MainThread]: On master: ROLLBACK
[0m17:40:11.005030 [debug] [MainThread]: On master: Close
[0m17:40:11.006589 [debug] [Thread-1 (]: Began running node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:40:11.006842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_snapshots, now model.my_dbt_postgres_project.my_first_dbt_model)
[0m17:40:11.007021 [debug] [Thread-1 (]: Began compiling node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:40:11.011672 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_postgres_project.my_first_dbt_model"
[0m17:40:11.012289 [debug] [Thread-1 (]: Began executing node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:40:11.012662 [debug] [Thread-1 (]: Finished running node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:40:11.012858 [debug] [Thread-1 (]: Began running node seed.my_dbt_postgres_project.country_codes
[0m17:40:11.013158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_postgres_project.my_first_dbt_model, now seed.my_dbt_postgres_project.country_codes)
[0m17:40:11.013462 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_postgres_project.country_codes
[0m17:40:11.014414 [debug] [Thread-1 (]: Began executing node seed.my_dbt_postgres_project.country_codes
[0m17:40:11.014849 [debug] [Thread-1 (]: Finished running node seed.my_dbt_postgres_project.country_codes
[0m17:40:11.015042 [debug] [Thread-1 (]: Began running node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:40:11.015280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_postgres_project.country_codes, now model.my_dbt_postgres_project.my_second_dbt_model)
[0m17:40:11.015503 [debug] [Thread-1 (]: Began compiling node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:40:11.016903 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_postgres_project.my_second_dbt_model"
[0m17:40:11.017383 [debug] [Thread-1 (]: Began executing node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:40:11.017721 [debug] [Thread-1 (]: Finished running node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:40:11.017908 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:40:11.018113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_postgres_project.my_second_dbt_model, now test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710)
[0m17:40:11.018337 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:40:11.024370 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:40:11.024743 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:40:11.025035 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:40:11.025199 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m17:40:11.025440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321)
[0m17:40:11.025670 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m17:40:11.028834 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321"
[0m17:40:11.029317 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m17:40:11.029635 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m17:40:11.029826 [debug] [Thread-1 (]: Began running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m17:40:11.030009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321, now snapshot.my_dbt_postgres_project.country_codes_snapshot)
[0m17:40:11.030160 [debug] [Thread-1 (]: Began compiling node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m17:40:11.031907 [debug] [Thread-1 (]: Began executing node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m17:40:11.032230 [debug] [Thread-1 (]: Finished running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m17:40:11.032399 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m17:40:11.032661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.my_dbt_postgres_project.country_codes_snapshot, now test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea)
[0m17:40:11.032915 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m17:40:11.034873 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea"
[0m17:40:11.035358 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m17:40:11.035659 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m17:40:11.035839 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m17:40:11.036027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea, now test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b)
[0m17:40:11.036223 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m17:40:11.037959 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b"
[0m17:40:11.038364 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m17:40:11.038644 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m17:40:11.038802 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m17:40:11.039012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b, now test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f)
[0m17:40:11.039193 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m17:40:11.043553 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f"
[0m17:40:11.043989 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m17:40:11.044271 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m17:40:11.044432 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:40:11.044656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f, now test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778)
[0m17:40:11.044858 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:40:11.046825 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778"
[0m17:40:11.047306 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:40:11.047614 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:40:11.047774 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:40:11.048051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778, now test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m17:40:11.048247 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:40:11.050291 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:40:11.050668 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:40:11.050978 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:40:11.051481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:11.051635 [debug] [MainThread]: Connection 'test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m17:40:11.052509 [debug] [MainThread]: Command end result
[0m17:40:11.099096 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m17:40:11.100988 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m17:40:11.104928 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m17:40:11.106649 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:40:11.106817 [info ] [MainThread]: Building catalog
[0m17:40:11.110860 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db.information_schema'
[0m17:40:11.114476 [debug] [ThreadPool]: Using postgres connection "dbt_db.information_schema"
[0m17:40:11.114631 [debug] [ThreadPool]: On dbt_db.information_schema: BEGIN
[0m17:40:11.114751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:11.131512 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m17:40:11.131812 [debug] [ThreadPool]: Using postgres connection "dbt_db.information_schema"
[0m17:40:11.132096 [debug] [ThreadPool]: On dbt_db.information_schema: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "dbt_db.information_schema"} */

    
    

    select
        'dbt_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('country_codes_snapshot')) or (upper(sch.nspname) = upper('schema_db') and
           upper(tbl.relname) = upper('my_second_dbt_model')) or (upper(sch.nspname) = upper('schema_db') and
           upper(tbl.relname) = upper('country_codes')) or (upper(sch.nspname) = upper('schema_db') and
           upper(tbl.relname) = upper('my_first_dbt_model')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:40:11.137653 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m17:40:11.139119 [debug] [ThreadPool]: On dbt_db.information_schema: ROLLBACK
[0m17:40:11.139566 [debug] [ThreadPool]: On dbt_db.information_schema: Close
[0m17:40:11.145000 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/maha/my_dbt_postgres_project/target/catalog.json
[0m17:40:11.156459 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m17:40:11.157520 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m17:40:11.157696 [info ] [MainThread]: Catalog written to /Users/maha/my_dbt_postgres_project/target/catalog.json
[0m17:40:11.159462 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.73284143, "process_in_blocks": "0", "process_kernel_time": 0.206408, "process_mem_max_rss": "127942656", "process_out_blocks": "0", "process_user_time": 1.030788}
[0m17:40:11.159800 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:40:11.159748 after 0.73 seconds
[0m17:40:11.159968 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:40:11.160086 [debug] [MainThread]: Connection 'dbt_db.information_schema' was properly closed.
[0m17:40:11.160241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063cec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ced00>]}
[0m17:40:11.160421 [debug] [MainThread]: Flushing usage events
[0m17:40:12.722855 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:40.265188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d3b10>]}


============================== 17:40:40.268154 | 354b5ceb-4740-403a-89fb-c94841b4c4d2 ==============================
[0m17:40:40.268154 [info ] [MainThread]: Running with dbt=1.9.8
[0m17:40:40.268473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/maha/.dbt', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 8084', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:40.358054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '354b5ceb-4740-403a-89fb-c94841b4c4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108818e90>]}
[0m17:40:40.391272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '354b5ceb-4740-403a-89fb-c94841b4c4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10944b460>]}
[0m17:43:45.958090 [error] [MainThread]: Encountered an error:

[0m17:43:45.966872 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m17:43:45.970610 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 185.74454, "process_in_blocks": "0", "process_kernel_time": 0.144473, "process_mem_max_rss": "113377280", "process_out_blocks": "0", "process_user_time": 0.794467}
[0m17:43:45.971317 [debug] [MainThread]: Command `dbt docs serve` failed at 17:43:45.971209 after 185.75 seconds
[0m17:43:45.971888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b72150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b72250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af8aa0>]}
[0m17:43:45.972411 [debug] [MainThread]: Flushing usage events
[0m17:43:46.671216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:10.444451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104346120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed3b10>]}


============================== 17:44:10.447976 | b89f1e52-f660-4fdb-afd0-81a45dbede18 ==============================
[0m17:44:10.447976 [info ] [MainThread]: Running with dbt=1.9.8
[0m17:44:10.448302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/maha/.dbt', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve --port 8084', 'send_anonymous_usage_stats': 'True'}
[0m17:44:10.577314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b89f1e52-f660-4fdb-afd0-81a45dbede18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481ce90>]}
[0m17:44:10.610981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b89f1e52-f660-4fdb-afd0-81a45dbede18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4b460>]}
[0m17:44:56.369483 [error] [MainThread]: Encountered an error:

[0m17:44:56.374173 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m17:44:56.376544 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 45.977974, "process_in_blocks": "0", "process_kernel_time": 0.144514, "process_mem_max_rss": "110362624", "process_out_blocks": "0", "process_user_time": 0.767077}
[0m17:44:56.377033 [debug] [MainThread]: Command `dbt docs serve` failed at 17:44:56.376963 after 45.98 seconds
[0m17:44:56.377389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d89b0>]}
[0m17:44:56.377620 [debug] [MainThread]: Flushing usage events
[0m17:44:56.957081 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:04.478720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ad3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ad3b10>]}


============================== 17:45:04.482186 | 749a0120-e47a-482f-bd19-0f891c97065c ==============================
[0m17:45:04.482186 [info ] [MainThread]: Running with dbt=1.9.8
[0m17:45:04.482503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/maha/.dbt', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:04.603022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '749a0120-e47a-482f-bd19-0f891c97065c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b20e90>]}
[0m17:45:04.636443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '749a0120-e47a-482f-bd19-0f891c97065c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11394b460>]}
[0m17:45:04.638259 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:45:04.685253 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m17:45:04.774771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:04.775028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:04.804354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '749a0120-e47a-482f-bd19-0f891c97065c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139ff450>]}
[0m17:45:04.815983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '749a0120-e47a-482f-bd19-0f891c97065c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114748b90>]}
[0m17:45:04.816225 [info ] [MainThread]: Found 2 models, 7 data tests, 1 seed, 1 snapshot, 433 macros
[0m17:45:04.816394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '749a0120-e47a-482f-bd19-0f891c97065c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146b3af0>]}
[0m17:45:04.817391 [info ] [MainThread]: 
[0m17:45:04.817574 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:04.817701 [info ] [MainThread]: 
[0m17:45:04.817926 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:45:04.819819 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_schema_db'
[0m17:45:04.854483 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m17:45:04.854748 [debug] [ThreadPool]: On list_dbt_db_schema_db: BEGIN
[0m17:45:04.855023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:04.869641 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m17:45:04.870011 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_schema_db"
[0m17:45:04.870198 [debug] [ThreadPool]: On list_dbt_db_schema_db: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_schema_db"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'schema_db'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'schema_db'
  
[0m17:45:04.874230 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m17:45:04.875275 [debug] [ThreadPool]: On list_dbt_db_schema_db: ROLLBACK
[0m17:45:04.884196 [debug] [ThreadPool]: On list_dbt_db_schema_db: Close
[0m17:45:04.884716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_schema_db, now list_dbt_db_snapshots)
[0m17:45:04.886086 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m17:45:04.886236 [debug] [ThreadPool]: On list_dbt_db_snapshots: BEGIN
[0m17:45:04.886355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:04.918761 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m17:45:04.919044 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_snapshots"
[0m17:45:04.919200 [debug] [ThreadPool]: On list_dbt_db_snapshots: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:45:04.938254 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.019 seconds
[0m17:45:04.939057 [debug] [ThreadPool]: On list_dbt_db_snapshots: ROLLBACK
[0m17:45:04.939440 [debug] [ThreadPool]: On list_dbt_db_snapshots: Close
[0m17:45:04.942778 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:04.943042 [debug] [MainThread]: On master: BEGIN
[0m17:45:04.943174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:04.949875 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:45:04.950115 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:04.950292 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:45:04.975619 [debug] [MainThread]: SQL status: SELECT 1 in 0.025 seconds
[0m17:45:04.976624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '749a0120-e47a-482f-bd19-0f891c97065c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b20530>]}
[0m17:45:04.976980 [debug] [MainThread]: On master: ROLLBACK
[0m17:45:04.977325 [debug] [MainThread]: On master: Close
[0m17:45:04.979859 [debug] [Thread-1 (]: Began running node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:45:04.980090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_db_snapshots, now model.my_dbt_postgres_project.my_first_dbt_model)
[0m17:45:04.980263 [debug] [Thread-1 (]: Began compiling node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:45:04.984568 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_postgres_project.my_first_dbt_model"
[0m17:45:04.985001 [debug] [Thread-1 (]: Began executing node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:45:04.985568 [debug] [Thread-1 (]: Finished running node model.my_dbt_postgres_project.my_first_dbt_model
[0m17:45:04.985797 [debug] [Thread-1 (]: Began running node seed.my_dbt_postgres_project.country_codes
[0m17:45:04.986048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_postgres_project.my_first_dbt_model, now seed.my_dbt_postgres_project.country_codes)
[0m17:45:04.986289 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_postgres_project.country_codes
[0m17:45:04.987168 [debug] [Thread-1 (]: Began executing node seed.my_dbt_postgres_project.country_codes
[0m17:45:04.987509 [debug] [Thread-1 (]: Finished running node seed.my_dbt_postgres_project.country_codes
[0m17:45:04.987688 [debug] [Thread-1 (]: Began running node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:45:04.987920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_postgres_project.country_codes, now model.my_dbt_postgres_project.my_second_dbt_model)
[0m17:45:04.988153 [debug] [Thread-1 (]: Began compiling node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:45:04.989503 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_postgres_project.my_second_dbt_model"
[0m17:45:04.989954 [debug] [Thread-1 (]: Began executing node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:45:04.990269 [debug] [Thread-1 (]: Finished running node model.my_dbt_postgres_project.my_second_dbt_model
[0m17:45:04.990449 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:45:04.990673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_postgres_project.my_second_dbt_model, now test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710)
[0m17:45:04.990880 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:45:04.996782 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:45:04.997176 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:45:04.997467 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:45:04.997633 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m17:45:04.997873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321)
[0m17:45:04.998116 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m17:45:05.001304 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321"
[0m17:45:05.001814 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m17:45:05.002116 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321
[0m17:45:05.002286 [debug] [Thread-1 (]: Began running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m17:45:05.002494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.unique_my_first_dbt_model_id.16e066b321, now snapshot.my_dbt_postgres_project.country_codes_snapshot)
[0m17:45:05.002692 [debug] [Thread-1 (]: Began compiling node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m17:45:05.004392 [debug] [Thread-1 (]: Began executing node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m17:45:05.004708 [debug] [Thread-1 (]: Finished running node snapshot.my_dbt_postgres_project.country_codes_snapshot
[0m17:45:05.004868 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m17:45:05.005034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.my_dbt_postgres_project.country_codes_snapshot, now test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea)
[0m17:45:05.005194 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m17:45:05.006966 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea"
[0m17:45:05.007361 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m17:45:05.007647 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea
[0m17:45:05.007815 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m17:45:05.007983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_country_codes_country_code.f36afebdea, now test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b)
[0m17:45:05.008132 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m17:45:05.009745 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b"
[0m17:45:05.010076 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m17:45:05.010355 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b
[0m17:45:05.010512 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m17:45:05.010675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_country_codes_country_name.b83efc697b, now test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f)
[0m17:45:05.010818 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m17:45:05.014803 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f"
[0m17:45:05.015264 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m17:45:05.015561 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f
[0m17:45:05.015718 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:45:05.015886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.unique_country_codes_country_code.ada89ec41f, now test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778)
[0m17:45:05.016026 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:45:05.017635 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778"
[0m17:45:05.017957 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:45:05.018228 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:45:05.018410 [debug] [Thread-1 (]: Began running node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:45:05.018577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_postgres_project.not_null_my_second_dbt_model_id.151b76d778, now test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m17:45:05.018723 [debug] [Thread-1 (]: Began compiling node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:45:05.020534 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:45:05.020829 [debug] [Thread-1 (]: Began executing node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:45:05.021103 [debug] [Thread-1 (]: Finished running node test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:45:05.021601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:05.021731 [debug] [MainThread]: Connection 'test.my_dbt_postgres_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m17:45:05.022502 [debug] [MainThread]: Command end result
[0m17:45:05.065108 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m17:45:05.067033 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m17:45:05.070393 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maha/my_dbt_postgres_project/target/run_results.json
[0m17:45:05.071841 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:45:05.072000 [info ] [MainThread]: Building catalog
[0m17:45:05.076179 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db.information_schema'
[0m17:45:05.079940 [debug] [ThreadPool]: Using postgres connection "dbt_db.information_schema"
[0m17:45:05.080095 [debug] [ThreadPool]: On dbt_db.information_schema: BEGIN
[0m17:45:05.080211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:05.096527 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m17:45:05.096769 [debug] [ThreadPool]: Using postgres connection "dbt_db.information_schema"
[0m17:45:05.096976 [debug] [ThreadPool]: On dbt_db.information_schema: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "my_dbt_postgres_project", "target_name": "dev", "connection_name": "dbt_db.information_schema"} */

    
    

    select
        'dbt_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('country_codes_snapshot')) or (upper(sch.nspname) = upper('schema_db') and
           upper(tbl.relname) = upper('country_codes')) or (upper(sch.nspname) = upper('schema_db') and
           upper(tbl.relname) = upper('my_first_dbt_model')) or (upper(sch.nspname) = upper('schema_db') and
           upper(tbl.relname) = upper('my_second_dbt_model')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:45:05.101768 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m17:45:05.103196 [debug] [ThreadPool]: On dbt_db.information_schema: ROLLBACK
[0m17:45:05.103620 [debug] [ThreadPool]: On dbt_db.information_schema: Close
[0m17:45:05.109172 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/maha/my_dbt_postgres_project/target/catalog.json
[0m17:45:05.120179 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maha/my_dbt_postgres_project/target/manifest.json
[0m17:45:05.121217 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maha/my_dbt_postgres_project/target/semantic_manifest.json
[0m17:45:05.121374 [info ] [MainThread]: Catalog written to /Users/maha/my_dbt_postgres_project/target/catalog.json
[0m17:45:05.122382 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.69073975, "process_in_blocks": "0", "process_kernel_time": 0.194988, "process_mem_max_rss": "129171456", "process_out_blocks": "0", "process_user_time": 1.032713}
[0m17:45:05.122647 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:45:05.122596 after 0.69 seconds
[0m17:45:05.122801 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:45:05.122916 [debug] [MainThread]: Connection 'dbt_db.information_schema' was properly closed.
[0m17:45:05.123069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ab4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b4ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b4ad00>]}
[0m17:45:05.123228 [debug] [MainThread]: Flushing usage events
[0m17:45:05.807882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:15.270845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d3b10>]}


============================== 17:45:15.273807 | 67691c14-6f9b-48d7-8a52-851bbc23deab ==============================
[0m17:45:15.273807 [info ] [MainThread]: Running with dbt=1.9.8
[0m17:45:15.274182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/maha/.dbt', 'log_path': '/Users/maha/my_dbt_postgres_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8084', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:15.364373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67691c14-6f9b-48d7-8a52-851bbc23deab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106520e90>]}
[0m17:45:15.397293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67691c14-6f9b-48d7-8a52-851bbc23deab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10724b460>]}
[0m17:54:42.637983 [error] [MainThread]: Encountered an error:

[0m17:54:42.647687 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/Users/maha/dbt-env/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m17:54:42.651793 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 567.4218, "process_in_blocks": "0", "process_kernel_time": 0.174219, "process_mem_max_rss": "110657536", "process_out_blocks": "0", "process_user_time": 0.836736}
[0m17:54:42.652536 [debug] [MainThread]: Command `dbt docs serve` failed at 17:54:42.652409 after 567.42 seconds
[0m17:54:42.653145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11008df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11008e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d89b0>]}
[0m17:54:42.653554 [debug] [MainThread]: Flushing usage events
[0m17:54:43.342919 [debug] [MainThread]: An error was encountered while trying to flush usage events
